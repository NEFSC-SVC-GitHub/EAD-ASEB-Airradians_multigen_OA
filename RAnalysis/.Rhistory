ggarrange(RR_startend_boxplot,ER_boxplot)
library(ggpubr)
ggarrange(RR_startend_boxplot,ER_boxplot)
O_N_facetted
#install.packages("pander")
library(dplyr)
library(ggplot2)
library(nlme)
library(lme4)
library(car)
# SET WORKING DIRECTORY
setwd("C:/Users/samjg/Documents/Github_repositories/Airradians_multigen_OA/RAnalysis") # personal computer
# LOAD DATA & cater to this script
Excretion_data <- read.csv(file="Data/Physiology/Excretion_rates/F1/cumultative_raw/Excretion_master.csv", header=T,stringsAsFactors=FALSE, fileEncoding="latin1") # master data file
Size_data   <- read.csv(file="Data/Physiology/Respiration/Reference_resp_size.csv", header=T)
list(unique(Excretion_data$Date)) # 20220202 20220301 20211026 20220922 20221026 - call these dates in the size data and only Loligo RR data (large animals measured excretion!)
Size_data_2 <- Size_data %>%
dplyr::mutate(Date = paste("20",(format(as.Date(Date, "%m/%d/%Y"), "%y%m%d")), sep ='')) %>% # change format of the date to the format in Excretion_data
dplyr::select(-c(Food, Shell_tin_weight, tin_plus_shell, Tissue_tin_.weight, tin_plus_tissue, Plate, Vessel_well_volume, Notes)) %>%  # get rid of unneeded column(s)
dplyr::filter(Date %in% unique(Excretion_data$Date)) %>% # 20220202 20220301 20211026 20220922 20221026- call these dates in te size dat
dplyr::filter(!Instrument %in% 'SDR_24channel') %>% # dates occasionally have resp for F2s with SDr, call the Loligo system for the correct animals
dplyr::select(-Instrument) # now we can omit Instrument column
nrow(Size_data_2) # 82
nrow(Excretion_data)
meanTDW <- mean(as.numeric(Size_data_2$Dry_Tissue_weight)) # 0.4729451
Excretion_master <- merge(Excretion_data, Size_data_2) %>% # merge size and excretion datadata
dplyr::filter(!ExcretionRate_umol_mL_hr < 0) %>% # 3 excretion < 0 omit (20211026 7.5C, 20220202 7.5C, 20220202 8.0C)
dplyr::mutate(ExcretionRate_umol_mL_hr_TDWbfactor =  ExcretionRate_umol_mL_hr*( (meanTDW/(as.numeric(Dry_Tissue_weight)))^0.822) ) %>% # correct ExcretionRate_umol_mL_hr for gram of Tissue Dry WEight
dplyr::mutate(pCO2 = case_when(pH == 8.0 ~ "500 μatm", pH == 7.5 ~ "800 μatm"))
# WRITE CSV OF THE MASTER FILE
write.csv(Excretion_master, "C:/Users/samjg/Documents/Github_repositories/Airradians_multigen_OA/RAnalysis/Output/ExcretionRates/ExcretionRates_master.csv")
ER <- read.csv(file="C:/Users/samjg/Documents/Github_repositories/Airradians_multigen_OA/RAnalysis/Output/ExcretionRates/ExcretionRates_master.csv", header=T)
nrow(ER)
Dry_Tissue_weight
# ::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
# GET B FACTOR FOR ALL AVAILABLE INDIVIDUALS WITH TDW AND MO2 ::::::::::::::::::::::::::::::
ER            <- ER %>% filter(!is.na(ER$ExcretionRate_umol_mL_hr))
ER$log10_VER  <- log10(as.numeric(ER$ExcretionRate_umol_mL_hr)) # assign resp value
ER$log10_TDW  <- log10(as.numeric(ER$Dry_Tissue_weight)) # assign length value
View(ER)
ER_b.factor_PLOT <- ER %>%
ggplot(aes(x=log10_TDW, y=log10_VER)) +
geom_point() +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
scale_x_continuous(name ="log10_BodyMass; TDW in g") +
scale_y_continuous(name ="log10_ER; ER in umol L-1 hr-1)") +
theme_classic() +
theme(legend.position="none",axis.title.y=element_text(size=7)) +
ggtitle("Excretion rate scaling: log10_MO2 = log10_a + (b.factor * log10_BodyMass)") +
geom_smooth(method = lm, color = 'red') +
ggpmisc::stat_poly_eq(parse=T, aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")), label.x.npc = "left")
ER_b.factor_PLOT
unique(Excretion_master$Date)
Excretion_master_211026 <- Excretion_master %>% filter(Date %in% '20211026') # call data
Excretion_master_0202 <- Excretion_master %>% filter(Date %in% '20220202') # call data
Excretion_master_0301 <- Excretion_master %>% filter(Date %in% '20220301') # call data
Excretion_master_0922 <- Excretion_master %>% filter(Date %in% '20220922') # call data
Excretion_master_221026 <- Excretion_master %>% filter(Date %in% '20221026') # call data
ER_b.factor_PLOT
ER %>%
#dplyr::filter(!ExcretionRate_umol_mL_hr_TDWbfactor > 30) %>% # two outliers?
ggplot(aes(x = factor(Date),
y = ExcretionRate_umol_mL_hr,
fill = pCO2)) +
geom_boxplot(alpha = 0.5, # color hue
width=0.6, # boxplot width
outlier.size=0, # make outliers small
position = position_dodge(preserve = "single")) +
geom_point(pch = 19,
position = position_jitterdodge(0.01),
size=1) +
scale_fill_manual(values=c("forestgreen","orange")) +
theme_classic() +
ggtitle("F1 Scallops: Excretion rate (umol O2 hr)") +
theme(legend.position="none",
axis.title.y=element_text(size=7),
axis.title.x=element_text(size=7),
axis.text.x=element_text(size=7)) +
#ylim(0, 0.2) +
stat_summary(fun.y=mean,
geom = "errorbar",
aes(ymax = ..y.., ymin = ..y..),
width = 0.6,
size=0.4,
linetype = "dashed",
position = position_dodge(preserve = "single"))  +
facet_wrap(~Date, scales = "free")
ER
ER_b.factor_PLOT
ER_b.factor_PLOT <- ER %>%
ggplot(aes(x=log10_TDW, y=log10_VER)) +
geom_point() +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
scale_x_continuous(name ="log10_BodyMass; TDW in g") +
scale_y_continuous(name ="log10_ER; ER in umol L-1 hr-1)") +
theme_classic() +
theme(legend.position="none",axis.title.y=element_text(size=7)) +
ggtitle("Excretion rate scaling: log10_MO2 = log10_a + (b.factor * log10_BodyMass)") +
geom_smooth(method = lm, color = 'red') +
ggpmisc::stat_poly_eq(parse=T, aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")), label.x.npc = "left")
ER_b.factor_PLOT
Excretion_master <- merge(Excretion_data, Size_data_2) %>% # merge size and excretion datadata
dplyr::filter(!ExcretionRate_umol_mL_hr < 0) %>% # 3 excretion < 0 omit (20211026 7.5C, 20220202 7.5C, 20220202 8.0C)
dplyr::mutate(ExcretionRate_umol_mL_hr_TDWbfactor =  ExcretionRate_umol_mL_hr*( (meanTDW/(as.numeric(Dry_Tissue_weight)))^0.78) ) %>% # correct ExcretionRate_umol_mL_hr for gram of Tissue Dry WEight
dplyr::mutate(pCO2 = case_when(pH == 8.0 ~ "500 μatm", pH == 7.5 ~ "800 μatm"))
# WRITE CSV OF THE MASTER FILE
write.csv(Excretion_master, "C:/Users/samjg/Documents/Github_repositories/Airradians_multigen_OA/RAnalysis/Output/ExcretionRates/ExcretionRates_master.csv")
# SET WORKING DIRECTORY
setwd("C:/Users/samjg/Documents/Github_repositories/Airradians_multigen_OA/RAnalysis") # personal computer
# LOAD DATA & cater to this script
Excretion_data <- read.csv(file="Data/Physiology/Excretion_rates/F1/cumultative_raw/Excretion_master.csv", header=T,stringsAsFactors=FALSE, fileEncoding="latin1") # master data file
Size_data   <- read.csv(file="Data/Physiology/Respiration/Reference_resp_size.csv", header=T)
list(unique(Excretion_data$Date)) # 20220202 20220301 20211026 20220922 20221026 - call these dates in the size data and only Loligo RR data (large animals measured excretion!)
Size_data_2 <- Size_data %>%
dplyr::mutate(Date = paste("20",(format(as.Date(Date, "%m/%d/%Y"), "%y%m%d")), sep ='')) %>% # change format of the date to the format in Excretion_data
dplyr::select(-c(Food, Shell_tin_weight, tin_plus_shell, Tissue_tin_.weight, tin_plus_tissue, Plate, Vessel_well_volume, Notes)) %>%  # get rid of unneeded column(s)
dplyr::filter(Date %in% unique(Excretion_data$Date)) %>% # 20220202 20220301 20211026 20220922 20221026- call these dates in te size dat
dplyr::filter(!Instrument %in% 'SDR_24channel') %>% # dates occasionally have resp for F2s with SDr, call the Loligo system for the correct animals
dplyr::select(-Instrument) # now we can omit Instrument column
nrow(Size_data_2) # 82
nrow(Excretion_data)
# ::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
# GET B FACTOR FOR ALL AVAILABLE INDIVIDUALS WITH TDW AND MO2 ::::::::::::::::::::::::::::::
ER            <- ER %>% filter(!is.na(ER$ExcretionRate_umol_mL_hr))
ER$log10_VER  <- log10(as.numeric(ER$ExcretionRate_umol_mL_hr)) # assign resp value
ER$log10_TDW  <- log10(as.numeric(ER$Dry_Tissue_weight)) # assign length value
ER_b.factor_PLOT <- ER %>%
ggplot(aes(x=log10_TDW, y=log10_VER)) +
geom_point() +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
scale_x_continuous(name ="log10_BodyMass; TDW in g") +
scale_y_continuous(name ="log10_ER; ER in umol L-1 hr-1)") +
theme_classic() +
theme(legend.position="none",axis.title.y=element_text(size=7)) +
ggtitle("Excretion rate scaling: log10_MO2 = log10_a + (b.factor * log10_BodyMass)") +
geom_smooth(method = lm, color = 'red') +
ggpmisc::stat_poly_eq(parse=T, aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")), label.x.npc = "left")
meanTDW <- mean(as.numeric(Size_data_2$Dry_Tissue_weight)) # 0.4729451
Excretion_master <- merge(Excretion_data, Size_data_2) %>% # merge size and excretion datadata
dplyr::filter(!ExcretionRate_umol_mL_hr < 0) %>% # 3 excretion < 0 omit (20211026 7.5C, 20220202 7.5C, 20220202 8.0C)
dplyr::mutate(ExcretionRate_umol_mL_hr_TDWbfactor =  ExcretionRate_umol_mL_hr*( (meanTDW/(as.numeric(Dry_Tissue_weight)))^0.78) ) %>% # correct ExcretionRate_umol_mL_hr for gram of Tissue Dry WEight
dplyr::mutate(pCO2 = case_when(pH == 8.0 ~ "500 μatm", pH == 7.5 ~ "800 μatm"))
ER_plot_raw <- Excretion_master %>%
#dplyr::filter(!ExcretionRate_umol_mL_hr_TDWbfactor > 30) %>% # two outliers?
ggplot(aes(x = factor(Date),
y = ExcretionRate_umol_mL_hr,
fill = pCO2)) +
geom_boxplot(alpha = 0.5, # color hue
width=0.6, # boxplot width
outlier.size=0, # make outliers small
position = position_dodge(preserve = "single")) +
geom_point(pch = 19,
position = position_jitterdodge(0.01),
size=1) +
scale_fill_manual(values=c("forestgreen","orange")) +
theme_classic() +
ggtitle("F1 Scallops: Excretion rate (umol O2 hr)") +
theme(legend.position="none",
axis.title.y=element_text(size=7),
axis.title.x=element_text(size=7),
axis.text.x=element_text(size=7)) +
#ylim(0, 0.2) +
stat_summary(fun.y=mean,
geom = "errorbar",
aes(ymax = ..y.., ymin = ..y..),
width = 0.6,
size=0.4,
linetype = "dashed",
position = position_dodge(preserve = "single"))  +
facet_wrap(~Date, scales = "free")
ER_plot_normalized <- Excretion_master %>%
#dplyr::filter(!ExcretionRate_umol_mL_hr_TDWbfactor > 30) %>% # two outliers?
ggplot(aes(x = factor(Date),
y = ExcretionRate_umol_mL_hr_TDWbfactor,
fill = pCO2)) +
geom_boxplot(alpha = 0.5, # color hue
width=0.6, # boxplot width
outlier.size=0, # make outliers small
position = position_dodge(preserve = "single")) +
geom_point(pch = 19,
position = position_jitterdodge(0.01),
size=1) +
scale_fill_manual(values=c("forestgreen","orange")) +
theme_classic() +
ggtitle("F1 Scallops: Excretion rate TDW normalized (umol O2 hr)") +
theme(legend.position="none",
axis.title.y=element_text(size=7),
axis.title.x=element_text(size=7),
axis.text.x=element_text(size=7)) +
#ylim(0, 0.2) +
stat_summary(fun.y=mean,
geom = "errorbar",
aes(ymax = ..y.., ymin = ..y..),
width = 0.6,
size=0.4,
linetype = "dashed",
position = position_dodge(preserve = "single"))  +
facet_wrap(~Date, scales = "free")
ER_plot_normalized
# WRITE CSV OF THE MASTER FILE
write.csv(Excretion_master, "C:/Users/samjg/Documents/Github_repositories/Airradians_multigen_OA/RAnalysis/Output/ExcretionRates/ExcretionRates_master.csv")
# LOAD DATA ::::::::::::::::::::::::::::::::::::::::::::::::::::
setwd("C:/Users/samjg/Documents/Github_repocsitories/Airradians_multigen_OA/RAnalysis")
ER            <- read.csv(file="Output/ExcretionRates/ExcretionRates_master.csv", header=T) %>% dplyr::select(-X)
setwd("C:/Users/samjg/Documents/Github_repocsitories/Airradians_multigen_OA/RAnalysis")
# LOAD DATA ::::::::::::::::::::::::::::::::::::::::::::::::::::
setwd("C:/Users/samjg/Documents/Github_repocsitories/Airradians_multigen_OA/RAnalysis")
# LOAD DATA ::::::::::::::::::::::::::::::::::::::::::::::::::::
setwd("C:/Users/samjg/Documents/Github_repocsitories/Airradians_multigen_OA/RAnalysis")
ER_plot_normalized <- ER %>%
#dplyr::filter(!ExcretionRate_umol_mL_hr_TDWbfactor > 30) %>% # two outliers?
ggplot(aes(x = factor(Date),
y = ExcretionRate_umol_mL_hr_TDWbfactor,
fill = pCO2)) +
geom_boxplot(alpha = 0.5, # color hue
width=0.6, # boxplot width
outlier.size=0, # make outliers small
position = position_dodge(preserve = "single")) +
geom_point(pch = 19,
position = position_jitterdodge(0.01),
size=1) +
scale_fill_manual(values=c("forestgreen","orange")) +
theme_classic() +
ggtitle("F1 Scallops: Excretion rate TDW normalized (umol O2 hr)") +
theme(legend.position="none",
axis.title.y=element_text(size=7),
axis.title.x=element_text(size=7),
axis.text.x=element_text(size=7)) +
#ylim(0, 0.2) +
stat_summary(fun.y=mean,
geom = "errorbar",
aes(ymax = ..y.., ymin = ..y..),
width = 0.6,
size=0.4,
linetype = "dashed",
position = position_dodge(preserve = "single"))  +
facet_wrap(~Date, scales = "free")
ER_plot_normalized
setwd("C:/Users/samjg/Documents/Github_repocsitories/Airradians_multigen_OA/RAnalysis")
Biodep_Master <- read.csv("C:/Users/samjg/Documents/Github_repositories/Airradians_multigen_OA/RAnalysis/Output/Biodeposition/Biodeposition_master.csv", header = T)
Biodep_Master <- na.omit(Biodep_Master) # omit #6 pH7.5 on 20221027
AE_boxplot <- Biodep_Master %>%
dplyr::mutate(Temperature = case_when(Date == '20220302' ~ '16C',
Date == '20220923' ~ '20C',
Date == '20221027' ~ '13.3C')) %>%
#filter(!AE < 0) %>%
ggplot(aes(pCO2 , AE , fill = pCO2)) +
theme(panel.grid=element_blank()) +
geom_boxplot(size=0.2, alpha=0.1, aes(fill=pCO2)) +
scale_fill_manual(values=c("forestgreen","orange")) +
geom_point(shape = 21, size = 2, position = position_jitterdodge(jitter.width = 0.1)) +
theme_classic() +
theme(axis.text=element_text(size=6),
axis.title=element_text(size=6)) +
stat_summary(fun.y=mean, geom="point", shape=18, size=4, color="black", fill="white") +
ggtitle("Assimilation Efficiency, F1 Scallops") +
theme(axis.text.x=element_blank()) +
facet_wrap(~Temperature)
AR_boxplot <- Biodep_Master %>%
dplyr::mutate(Temperature = case_when(Date == '20220302' ~ '16C',
Date == '20220923' ~ '20C',
Date == '20221027' ~ '13.3C')) %>%
# filter(!AE < 0) %>%
ggplot(aes(pCO2 , AR , fill = pCO2)) +
theme(panel.grid=element_blank()) +
geom_boxplot(size=0.2, alpha=0.1, aes(fill=pCO2)) +
scale_fill_manual(values=c("forestgreen","orange")) +
geom_point(shape = 21, size = 2, position = position_jitterdodge(jitter.width = 0.1)) +
theme_classic() +
theme(axis.text=element_text(size=6),
axis.title=element_text(size=6)) +
stat_summary(fun.y=mean, geom="point", shape=18, size=4, color="black", fill="white") +
ggtitle("Assimilation Rate, F1 Scallops") +
theme(axis.text.x=element_blank()) +
facet_wrap(~Temperature)
OIR_boxplot <- Biodep_Master %>%
dplyr::mutate(Temperature = case_when(Date == '20220302' ~ '16C',
Date == '20220923' ~ '20C',
Date == '20221027' ~ '13.3C')) %>%
#filter(!AE < 0) %>%
ggplot(aes(pCO2 , OIR , fill = pCO2)) +
theme(panel.grid=element_blank()) +
geom_boxplot(size=0.2, alpha=0.1, aes(fill=pCO2)) +
scale_fill_manual(values=c("forestgreen","orange")) +
geom_point(shape = 21, size = 2, position = position_jitterdodge(jitter.width = 0.1)) +
theme_classic() +
theme(axis.text=element_text(size=6),
axis.title=element_text(size=6)) +
stat_summary(fun.y=mean, geom="point", shape=18, size=4, color="black", fill="white") +
ggtitle("Organic Ingestion Rate, F1 Scallops") +
theme(axis.text.x=element_blank()) +
facet_wrap(~Temperature)
FR_boxplot <- Biodep_Master %>%
dplyr::mutate(Temperature = case_when(Date == '20220302' ~ '16C',
Date == '20220923' ~ '20C',
Date == '20221027' ~ '13.3C')) %>%
#filter(!AE < 0) %>%
ggplot(aes(pCO2 , FR , fill = pCO2)) +
theme(panel.grid=element_blank()) +
geom_boxplot(size=0.2, alpha=0.1, aes(fill=pCO2)) +
scale_fill_manual(values=c("forestgreen","orange")) +
geom_point(shape = 21, size = 2, position = position_jitterdodge(jitter.width = 0.1)) +
theme_classic() +
theme(axis.text=element_text(size=6),
axis.title=element_text(size=6)) +
stat_summary(fun.y=mean, geom="point", shape=18, size=4, color="black", fill="white") +
ggtitle("Filtration Rate, F1 Scallops") +
theme(axis.text.x=element_blank()) +
facet_wrap(~Temperature)
RR_boxplot <- Biodep_Master %>%
dplyr::mutate(Temperature = case_when(Date == '20220302' ~ '16C',
Date == '20220923' ~ '20C',
Date == '20221027' ~ '13.3C')) %>%
#filter(!AE < 0) %>%
ggplot(aes(pCO2 , RR_Percent , fill = pCO2)) +
theme(panel.grid=element_blank()) +
geom_boxplot(size=0.2, alpha=0.1, aes(fill=pCO2)) +
scale_fill_manual(values=c("forestgreen","orange")) +
geom_point(shape = 21, size = 2, position = position_jitterdodge(jitter.width = 0.1)) +
theme_classic() +
theme(axis.text=element_text(size=6),
axis.title=element_text(size=6)) +
stat_summary(fun.y=mean, geom="point", shape=18, size=4, color="black", fill="white") +
ggtitle("Percent Rejection Rate, F1 Scallops") +
theme(axis.text.x=element_blank()) +
facet_wrap(~Temperature)
SE_boxplot <- Biodep_Master %>%
dplyr::mutate(Temperature = case_when(Date == '20220302' ~ '16C',
Date == '20220923' ~ '20C',
Date == '20221027' ~ '13.3C')) %>%
#filter(!AE < 0) %>%
ggplot(aes(pCO2 , SE , fill = pCO2)) +
theme(panel.grid=element_blank()) +
geom_boxplot(size=0.2, alpha=0.1, aes(fill=pCO2)) +
scale_fill_manual(values=c("forestgreen","orange")) +
geom_point(shape = 21, size = 2, position = position_jitterdodge(jitter.width = 0.1)) +
theme_classic() +
theme(axis.text=element_text(size=6),
axis.title=element_text(size=6)) +
stat_summary(fun.y=mean, geom="point", shape=18, size=4, color="black", fill="white") +
ggtitle("Selection Efficiency, F1 Scallops") +
theme(axis.text.x=element_blank()) +
facet_wrap(~Temperature)
CR_correct_boxplot <- Biodep_Master %>%
dplyr::mutate(Temperature = case_when(Date == '20220302' ~ '16C',
Date == '20220923' ~ '20C',
Date == '20221027' ~ '13.3C')) %>%
#filter(!AE < 0) %>%
ggplot(aes(pCO2 , CR_correct , fill = pCO2)) +
theme(panel.grid=element_blank()) +
geom_boxplot(size=0.2, alpha=0.1, aes(fill=pCO2)) +
scale_fill_manual(values=c("forestgreen","orange")) +
geom_point(shape = 21, size = 2, position = position_jitterdodge(jitter.width = 0.1)) +
theme_classic() +
theme(axis.text=element_text(size=6),
axis.title=element_text(size=6)) +
stat_summary(fun.y=mean, geom="point", shape=18, size=4, color="black", fill="white") +
ggtitle("Clearance Rate, F1 Scallops") +
theme(axis.text.x=element_blank()) +
facet_wrap(~Temperature)
CR_correct_boxplot
ggarrange(SE_boxplot,
RR_boxplot,
OIR_boxplot,
CR_correct_boxplot,
FR_boxplot,
AE_boxplot,
AR_boxplot)
setwd("C:/Users/samjg/Documents/Github_repositories/Airradians_multigen_OA/RAnalysis") # personal computer
# LOAD DATA ::::::::::::::::::::::::::::::::::::::::::::::::::::
ER            <- read.csv(file="Output/ExcretionRates/ExcretionRates_master.csv", header=T) %>% dplyr::select(-X)
ER_boxplot <- ER %>%
#dplyr::filter(!ExcretionRate_umol_mL_hr_TDWbfactor > 30) %>% # two outliers?
ggplot(aes(x = factor(Date),
y = ExcretionRate_umol_mL_hr,
fill = pCO2)) +
geom_boxplot(alpha = 0.5, # color hue
width=0.6, # boxplot width
outlier.size=0, # make outliers small
position = position_dodge(preserve = "single")) +
geom_point(pch = 19,
position = position_jitterdodge(0.01),
size=1) +
scale_fill_manual(values=c("forestgreen","orange")) +
theme_classic() +
ggtitle("F1 Scallops: Excretion rate (umol O2 hr)") +
theme(legend.position="none",
axis.title.y=element_text(size=7),
axis.title.x=element_text(size=7),
axis.text.x=element_text(size=7)) +
#ylim(0, 0.2) +
stat_summary(fun.y=mean,
geom = "errorbar",
aes(ymax = ..y.., ymin = ..y..),
width = 0.6,
size=0.4,
linetype = "dashed",
position = position_dodge(preserve = "single"))  +
facet_wrap(~Date, scales = "free")
ER_boxplot
setwd("C:/Users/samjg/Documents/Github_repositories/Airradians_multigen_OA/RAnalysis") # personal computer
ER            <- read.csv(file="Output/ExcretionRates/ExcretionRates_master.csv", header=T) %>% dplyr::select(-X)
setwd("C:/Users/samjg/Documents/Github_repositories/Airradians_multigen_OA/RAnalysis") # personal computer
ER     <- read.csv(file="Output/ExcretionRates/ExcretionRates_master.csv", header=T) %>% dplyr::select(-X)
ER
ER_b.factor_PLOT <- ER %>%
ggplot(aes(x=log10_TDW, y=log10_VER)) +
geom_point() +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
scale_x_continuous(name ="log10_BodyMass; TDW in g") +
scale_y_continuous(name ="log10_ER; ER in umol L-1 hr-1)") +
theme_classic() +
theme(legend.position="none",axis.title.y=element_text(size=7)) +
ggtitle("Excretion rate scaling: log10_ER = log10_a + (b.factor * log10_TDW)") +
geom_smooth(method = lm, color = 'red') +
ggpmisc::stat_poly_eq(parse=T, aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")), label.x.npc = "left")
ER_b.factor_PLOT
ER
setwd("C:/Users/samjg/Documents/Github_repocsitories/Airradians_multigen_OA/RAnalysis")
O_N_Master <- merge(RR_start.end_2,ER)  %>%
dplyr::mutate(O_N =Start.End_RR_umolhr/ ExcretionRate_umol_mL_hr)
# format the dates of RR to align with the ER data
RR_start.end_2 <- RR_start.end %>%
dplyr::mutate(Date =
paste("20",(format(as.Date(Date, "%m/%d/%Y"),
"%y%m%d")),
sep ='')) %>% # change format of the date to the format in Excretion_data
dplyr::filter(Date %in% c('20211026',
'20220202',
'20220301',
'20220922',
'20221026')) %>%
dplyr::filter(filetype %in% 'LoLigo_data') %>%
dplyr::mutate(Replicate = gsub(".*_","",Chamber_tank)) %>%
dplyr::select(-(c(filetype, Length_um, Dry_Tissue_weight_mg, Whole_Dry_weight_mg))) # do not need it anymore!
O_N_facetted <- O_N_Master %>%
#dplyr::filter(!ExcretionRate_umol_mL_hr_TDWbfactor > 30) %>% # two outliers?
ggplot(aes(x = factor(Date),
y = O_N,
fill = pCO2)) +
geom_boxplot(alpha = 0.5, # color hue
width=0.6, # boxplot width
outlier.size=0, # make outliers small
position = position_dodge(preserve = "single")) +
geom_point(pch = 19,
position = position_jitterdodge(0.01),
size=1) +
scale_fill_manual(values=c("forestgreen","orange")) +
theme_classic() +
ggtitle("F1 Scallops: O:N (umol O2 hr)") +
theme(legend.position="none",
axis.title.y=element_text(size=7),
axis.title.x=element_text(size=7),
axis.text.x=element_text(size=7)) +
#ylim(0, 0.2) +
stat_summary(fun.y=mean,
geom = "errorbar",
aes(ymax = ..y.., ymin = ..y..),
width = 0.6,
size=0.4,
linetype = "dashed",
position = position_dodge(preserve = "single"))  +
facet_wrap(~Date, scales = "free")
O_N_facetted
setwd("C:/Users/samjg/Documents/Github_repositories/Airradians_multigen_OA/RAnalysis") # personal computer
RR_start.end  <- read.csv(file="Output/Respiration/RR_start_end_master.csv", header=T)  %>% dplyr::select(-X)
ER            <- read.csv(file="Output/ExcretionRates/ExcretionRates_master.csv", header=T) %>% dplyr::select(-X)
# format the dates of RR to align with the ER data
RR_start.end_2 <- RR_start.end %>%
dplyr::mutate(Date =
paste("20",(format(as.Date(Date, "%m/%d/%Y"),
"%y%m%d")),
sep ='')) %>% # change format of the date to the format in Excretion_data
dplyr::filter(Date %in% c('20211026',
'20220202',
'20220301',
'20220922',
'20221026')) %>%
dplyr::filter(filetype %in% 'LoLigo_data') %>%
dplyr::mutate(Replicate = gsub(".*_","",Chamber_tank)) %>%
dplyr::select(-(c(filetype, Length_um, Dry_Tissue_weight_mg, Whole_Dry_weight_mg))) # do not need it anymore!
O_N_Master <- merge(RR_start.end_2,ER)  %>%
dplyr::mutate(O_N =Start.End_RR_umolhr/ ExcretionRate_umol_mL_hr)
O_N_facetted <- O_N_Master %>%
#dplyr::filter(!ExcretionRate_umol_mL_hr_TDWbfactor > 30) %>% # two outliers?
ggplot(aes(x = factor(Date),
y = O_N,
fill = pCO2)) +
geom_boxplot(alpha = 0.5, # color hue
width=0.6, # boxplot width
outlier.size=0, # make outliers small
position = position_dodge(preserve = "single")) +
geom_point(pch = 19,
position = position_jitterdodge(0.01),
size=1) +
scale_fill_manual(values=c("forestgreen","orange")) +
theme_classic() +
ggtitle("F1 Scallops: O:N (umol O2 hr)") +
theme(legend.position="none",
axis.title.y=element_text(size=7),
axis.title.x=element_text(size=7),
axis.text.x=element_text(size=7)) +
#ylim(0, 0.2) +
stat_summary(fun.y=mean,
geom = "errorbar",
aes(ymax = ..y.., ymin = ..y..),
width = 0.6,
size=0.4,
linetype = "dashed",
position = position_dodge(preserve = "single"))  +
facet_wrap(~Date, scales = "free")
O_N_facetted
