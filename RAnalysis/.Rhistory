dplyr::mutate(Length_mm = as.numeric(Length_um/1000)) %>%
dplyr::select(c('Date','pH','Length_mm','Biovolume_g_in_sw')) %>%
dplyr::mutate(Width_mm_estimate = (1/3)*Length_mm) %>%
dplyr::mutate(h = as.numeric(Width_mm_estimate / 2))
Reference_resp_size[!is.na(Reference_resp_size$Biovolume_g_in_sw),] %>%
dplyr::filter(!Biovolume_g_in_sw %in% '<add here>') %>%
dplyr::mutate(Length_mm = as.numeric(Length_um/1000)) %>%
dplyr::select(c('Date','pH','Length_mm','Biovolume_g_in_sw')) %>%
dplyr::mutate(Width_mm_estimate = (1/3)*Length_mm) %>%
dplyr::mutate(h = as.numeric(Width_mm_estimate / 2)) %>%
dplyr::mutate(a = as.numeric(Length_mm/2)) %>%
dplyr::mutate(Cap_vol <- ((1/6)*3.14*h)*(3*(a^2) + h^2))
Reference_resp_sizeOM <- Reference_resp_size[!is.na(Reference_resp_size$Biovolume_g_in_sw),] %>%
dplyr::filter(!Biovolume_g_in_sw %in% '<add here>') %>%
dplyr::mutate(Length_mm = as.numeric(Length_um/1000)) %>%
dplyr::select(c('Date','pH','Length_mm','Biovolume_g_in_sw')) %>%
dplyr::mutate(Width_mm_estimate = (1/3)*Length_mm) %>%
dplyr::mutate(h = as.numeric(Width_mm_estimate / 2)) %>%
dplyr::mutate(a = as.numeric(Length_mm/2)) %>%
dplyr::mutate(Cap_vol = ((1/6)*3.14*h)*(3*(a^2) + h^2)) %>%
dplyr::mutate(Biovol_estimate_mL3 = Cap_vol*2)
Reference_resp_sizeOM
Reference_resp_sizeOM <- Reference_resp_size[!is.na(Reference_resp_size$Biovolume_g_in_sw),] %>%
dplyr::filter(!Biovolume_g_in_sw %in% '<add here>') %>%
dplyr::mutate(Length_mm = as.numeric(Length_um/1000)) %>%
dplyr::select(c('Date','pH','Length_mm','Biovolume_g_in_sw')) %>%
dplyr::mutate(Width_mm_estimate = (1/5)*Length_mm) %>%
dplyr::mutate(h = as.numeric(Width_mm_estimate / 2)) %>%
dplyr::mutate(a = as.numeric(Length_mm/2)) %>%
dplyr::mutate(Cap_vol = ((1/6)*3.14*h)*(3*(a^2) + h^2)) %>%
dplyr::mutate(Biovol_estimate_mL3 = Cap_vol*2)
Reference_resp_sizeOM
Reference_resp_sizeOM <- Reference_resp_size[!is.na(Reference_resp_size$Biovolume_g_in_sw),] %>%
dplyr::filter(!Biovolume_g_in_sw %in% '<add here>') %>%
dplyr::mutate(Length_mm = as.numeric(Length_um/1000)) %>%
dplyr::select(c('Date','pH','Length_mm','Biovolume_g_in_sw')) %>%
dplyr::mutate(Width_mm_estimate = (1/3)*Length_mm) %>%
dplyr::mutate(h = as.numeric(Width_mm_estimate / 2)) %>%
dplyr::mutate(a = as.numeric(Length_mm/2)) %>%
dplyr::mutate(Cap_vol = ((1/6)*3.14*h)*(3*(a^2) + h^2)) %>%
dplyr::mutate(Biovol_estimate_mL3 = Cap_vol*2)
Reference_resp_sizeOM <- Reference_resp_size[!is.na(Reference_resp_size$Biovolume_g_in_sw),] %>%
dplyr::filter(!Biovolume_g_in_sw %in% '<add here>') %>%
dplyr::mutate(Length_mm = as.numeric(Length_um/1000)) %>%
dplyr::select(c('Date','pH','Length_mm','Biovolume_g_in_sw')) %>%
dplyr::mutate(Width_mm_estimate = (1/3)*Length_mm) %>%
dplyr::mutate(h = as.numeric(Width_mm_estimate / 2)) %>%
dplyr::mutate(a = as.numeric(Length_mm/2)) %>%
dplyr::mutate(Cap_vol_L = ((1/6)*3.14*h)*(3*(a^2) + h^2)) %>%
dplyr::mutate(Biovol_estimate_mL3 = (Cap_vol_L*2)/1000)
Reference_resp_sizeOM
Reference_resp_sizeOM <- Reference_resp_size[!is.na(Reference_resp_size$Biovolume_g_in_sw),] %>%
dplyr::filter(!Biovolume_g_in_sw %in% '<add here>') %>%
dplyr::mutate(Length_mm = as.numeric(Length_um/1000)) %>%
dplyr::select(c('Date','pH','Length_mm','Biovolume_g_in_sw')) %>%
dplyr::mutate(Width_mm_estimate = (1/5)*Length_mm) %>%
dplyr::mutate(h = as.numeric(Width_mm_estimate / 2)) %>%
dplyr::mutate(a = as.numeric(Length_mm/2)) %>%
dplyr::mutate(Cap_vol_L = ((1/6)*3.14*h)*(3*(a^2) + h^2)) %>%
dplyr::mutate(Biovol_estimate_mL3 = (Cap_vol_L*2)/1000)
Reference_resp_sizeOM
Reference_resp_sizeOM <- Reference_resp_size[!is.na(Reference_resp_size$Biovolume_g_in_sw),] %>%
dplyr::filter(!Biovolume_g_in_sw %in% '<add here>') %>%
dplyr::mutate(Length_mm = as.numeric(Length_um/1000)) %>%
dplyr::select(c('Date','pH','Length_mm','Biovolume_g_in_sw')) %>%
dplyr::mutate(Width_mm_estimate = (1/4)*Length_mm) %>%
dplyr::mutate(h = as.numeric(Width_mm_estimate / 2)) %>%
dplyr::mutate(a = as.numeric(Length_mm/2)) %>%
dplyr::mutate(Cap_vol_L = ((1/6)*3.14*h)*(3*(a^2) + h^2)) %>%
dplyr::mutate(Biovol_estimate_mL3 = (Cap_vol_L*2)/1000)
Reference_resp_sizeOM
Reference_resp_sizeOM <- Reference_resp_size[!is.na(Reference_resp_size$Biovolume_g_in_sw),] %>%
dplyr::filter(!Biovolume_g_in_sw %in% '<add here>') %>%
dplyr::mutate(Length_mm = as.numeric(Length_um/1000)) %>%
dplyr::select(c('Date','pH','Length_mm','Biovolume_g_in_sw')) %>%
dplyr::mutate(Width_mm_estimate = (1/3)*Length_mm) %>%
dplyr::mutate(h = as.numeric(Width_mm_estimate / 2)) %>%
dplyr::mutate(a = as.numeric(Length_mm/2)) %>%
dplyr::mutate(Cap_vol_L = ((1/6)*3.14*h)*(3*(a^2) + h^2)) %>%
dplyr::mutate(Biovol_estimate_mL3 = (Cap_vol_L*2)/1000)
Reference_resp_sizeOM <- Reference_resp_size[!is.na(Reference_resp_size$Biovolume_g_in_sw),] %>%
dplyr::filter(!Biovolume_g_in_sw %in% '<add here>') %>%
dplyr::mutate(Length_mm = as.numeric(Length_um/1000)) %>%
dplyr::select(c('Date','pH','Length_mm','Biovolume_g_in_sw')) %>%
dplyr::mutate(Thickness_mm_estimate = (1/3)*Length_mm) %>%
dplyr::mutate(h = as.numeric(Thickness_mm_estimate / 2)) %>%
dplyr::mutate(a = as.numeric(Length_mm/2)) %>%
dplyr::mutate(Cap_vol_L = ((1/6)*3.14*h)*(3*(a^2) + h^2)) %>%
dplyr::mutate(Biovol_estimate_mL3 = (Cap_vol_L*2)/1000)
# colnames(Reference_resp_sizeOM)
Biov_length_regression <- Reference_resp_sizeOM %>%
ggplot(aes(x=Biovol_estimate_mL3, y=Biovolume_g_in_sw, color = as.factor(pH))) +
geom_point()
Biov_length_regression
Reference_resp_sizeOM <- Reference_resp_size[!is.na(Reference_resp_size$Biovolume_g_in_sw),] %>%
dplyr::filter(!Biovolume_g_in_sw %in% '<add here>') %>%
dplyr::mutate(Length_mm = as.numeric(Length_um/1000)) %>%
dplyr::select(c('Date','pH','Length_mm','Biovolume_g_in_sw')) %>%
dplyr::mutate(Thickness_mm_estimate = (1/2.8)*Length_mm) %>%
dplyr::mutate(h = as.numeric(Thickness_mm_estimate / 2)) %>%
dplyr::mutate(a = as.numeric(Length_mm/2)) %>%
dplyr::mutate(Cap_vol_L = ((1/6)*3.14*h)*(3*(a^2) + h^2)) %>%
dplyr::mutate(Biovol_estimate_mL3 = (Cap_vol_L*2)/1000)
# colnames(Reference_resp_sizeOM)
Biov_length_regression <- Reference_resp_sizeOM %>%
ggplot(aes(x=Biovol_estimate_mL3, y=Biovolume_g_in_sw, color = as.factor(pH))) +
geom_point()
Biov_length_regression
Reference_resp_sizeOM <- Reference_resp_size[!is.na(Reference_resp_size$Biovolume_g_in_sw),] %>%
dplyr::filter(!Biovolume_g_in_sw %in% '<add here>') %>%
dplyr::mutate(Length_mm = as.numeric(Length_um/1000)) %>%
dplyr::select(c('Date','pH','Length_mm','Biovolume_g_in_sw')) %>%
dplyr::mutate(Thickness_mm_estimate = (1/2)*Length_mm) %>%
dplyr::mutate(h = as.numeric(Thickness_mm_estimate / 2)) %>%
dplyr::mutate(a = as.numeric(Length_mm/2)) %>%
dplyr::mutate(Cap_vol_L = ((1/6)*3.14*h)*(3*(a^2) + h^2)) %>%
dplyr::mutate(Biovol_estimate_mL3 = (Cap_vol_L*2)/1000)
# colnames(Reference_resp_sizeOM)
Biov_length_regression <- Reference_resp_sizeOM %>%
ggplot(aes(x=Biovol_estimate_mL3, y=Biovolume_g_in_sw, color = as.factor(pH))) +
geom_point()
Biov_length_regression
Reference_resp_sizeOM <- Reference_resp_size[!is.na(Reference_resp_size$Biovolume_g_in_sw),] %>%
dplyr::filter(!Biovolume_g_in_sw %in% '<add here>') %>%
dplyr::mutate(Length_mm = as.numeric(Length_um/1000)) %>%
dplyr::select(c('Date','pH','Length_mm','Biovolume_g_in_sw')) %>%
dplyr::mutate(Thickness_mm_estimate = (1/2.2)*Length_mm) %>%
dplyr::mutate(h = as.numeric(Thickness_mm_estimate / 2)) %>%
dplyr::mutate(a = as.numeric(Length_mm/2)) %>%
dplyr::mutate(Cap_vol_L = ((1/6)*3.14*h)*(3*(a^2) + h^2)) %>%
dplyr::mutate(Biovol_estimate_mL3 = (Cap_vol_L*2)/1000)
# colnames(Reference_resp_sizeOM)
Biov_length_regression <- Reference_resp_sizeOM %>%
ggplot(aes(x=Biovol_estimate_mL3, y=Biovolume_g_in_sw, color = as.factor(pH))) +
geom_point()
Biov_length_regression
Reference_resp_sizeOM
# LOAD PACKAGES :::::::::::::::::::::::::::::::::::::::::::::::::::::::
library(dplyr)
library(ggplot2)
library(forcats)
library(lme4)
library(lmerTest)
library(performance)
library(car)
library(kableExtra)
library(pander)
library(data.table)
library(Rmisc)
library(devtools)
library(ggpubr)
library(SciViews)
# SET WORKING DIRECTORY :::::::::::::::::::::::::::::::::::::::::::::::
setwd("C:/Users/samjg/Documents/Github_repositories/Airradians_multigen_OA/RAnalysis") # personal computer
# setwd("C:/Users/samjg/Documents/Github_repositories/Airradians_multigen_OA/RAnalysis") # Work computer
# LOAD DATA :::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
# biovolume data taken for adult Argopecten irradians in Gurr et al. 2021
Gurr2021_biovol       <- read.csv(file="Data/Physiology/Length/Reference_Gurr_etal_2021.csv", header=T)
Gurr2021_biovol
# SET WORKING DIRECTORY :::::::::::::::::::::::::::::::::::::::::::::::
setwd("C:/Users/samjg/Documents/Github_repositories/Airradians_multigen_OA/RAnalysis") # personal computer
# setwd("C:/Users/samjg/Documents/Github_repositories/Airradians_multigen_OA/RAnalysis") # Work computer
# LOAD DATA :::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
# biovolume data taken for adult Argopecten irradians in Gurr et al. 2021
Gurr2021_biovol  <- read.csv(file="Data/Physiology/Length/Reference_Gurr_etal_2021.csv", header=T) # 123 bay scallop (Ai) samples with biovolume
# size reference for resp rate data  - actual biovolume only on few timepoints
Reference_resp_size   <- read.csv(file="Data/Physiology/Respiration/Reference_resp_size.csv", header=T)
# resp rate data
RR_master <- read.csv(file="Output/Respiration/Calculated_Resp_Master.csv", header=T) %>%
filter(!Food %in% 'unfed') %>% # omit low food trial data
filter(!Date %in% '8/30/2022') %>% # an F2 measurement
dplyr::mutate(resp_umol_L_hr_mg_WDW =
resp_umol_L_hr/as.numeric(whole_Dry_weight)) %>%  # call whole dry weight corrected MO2
dplyr::mutate(resp_umol_L_hr_mmLength =
resp_umol_L_hr/ (1000/Length_um))  %>% # call length corrected MO2
# unique(RR_master$Date) # "10/26/2021" "2/2/2022"   "3/1/2022"   "8/30/2022"  "9/14/2021"  "9/22/2022"  "9/30/2021"
dplyr::mutate(Age = case_when(Date == '9/14/2021'  ~ 50,
Date == '9/30/2021'  ~ 66,
Date == '10/26/2021'  ~ 92,
Date == '2/2/2022' ~ 191,
Date == '3/1/2022'  ~ 218,
Date == '9/22/2022'  ~ 423,
Date == '10/26/2022' ~ 457)) %>%
dplyr::mutate(Age = as.factor(Age)) %>%
dplyr::arrange(Age)
# LOAD PACKAGES :::::::::::::::::::::::::::::::::::::::::::::::::::::::
library(dplyr)
library(ggplot2)
library(forcats)
library(lme4)
library(lmerTest)
library(performance)
library(car)
library(kableExtra)
library(pander)
library(data.table)
library(Rmisc)
library(devtools)
library(ggpubr)
library(SciViews)
# SET WORKING DIRECTORY :::::::::::::::::::::::::::::::::::::::::::::::
setwd("C:/Users/samjg/Documents/Github_repositories/Airradians_multigen_OA/RAnalysis") # personal computer
# setwd("C:/Users/samjg/Documents/Github_repositories/Airradians_multigen_OA/RAnalysis") # Work computer
# LOAD DATA :::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
# biovolume data taken for adult Argopecten irradians in Gurr et al. 2021
Gurr2021_biovol  <- read.csv(file="Data/Physiology/Length/Reference_Gurr_etal_2021.csv", header=T) # 123 bay scallop (Ai) samples with biovolume
# size reference for resp rate data  - actual biovolume only on few timepoints
Reference_resp_size   <- read.csv(file="Data/Physiology/Respiration/Reference_resp_size.csv", header=T)
# resp rate data
RR_master <- read.csv(file="Output/Respiration/Calculated_Resp_Master.csv", header=T) %>%
filter(!Food %in% 'unfed') %>% # omit low food trial data
filter(!Date %in% '8/30/2022') %>% # an F2 measurement
dplyr::mutate(resp_umol_L_hr_mg_WDW =
resp_umol_L_hr/as.numeric(whole_Dry_weight)) %>%  # call whole dry weight corrected MO2
dplyr::mutate(resp_umol_L_hr_mmLength =
resp_umol_L_hr/ (1000/Length_um))  %>% # call length corrected MO2
# unique(RR_master$Date) # "10/26/2021" "2/2/2022"   "3/1/2022"   "8/30/2022"  "9/14/2021"  "9/22/2022"  "9/30/2021"
dplyr::mutate(Age = case_when(Date == '9/14/2021'  ~ 50,
Date == '9/30/2021'  ~ 66,
Date == '10/26/2021'  ~ 92,
Date == '2/2/2022' ~ 191,
Date == '3/1/2022'  ~ 218,
Date == '9/22/2022'  ~ 423,
Date == '10/26/2022' ~ 457)) %>%
dplyr::mutate(Age = as.factor(Age)) %>%
dplyr::arrange(Age)
RR_master
# since we only have shell length, what is the average relationship of length to width and thickness to generate volume?
Gurr2021_size.relationships <- Gurr2021_biovol %>%
dplyr::filter(species %in% 'Ai') %>%
dplyr::select(c('pre_biovolume_mL', 'length_mm', 'width_mm', 'thickness_mm')) %>%
dplyr::mutate(length.biov = (length_mm/pre_biovolume_mL)) %>%
dplyr::mutate(length.width = (length_mm/width_mm)) %>%
dplyr::mutate(length.thick = (length_mm/thickness_mm))
Gurr2021_size.relationships[!is.na(Gurr2021_size.relationships$length_mm),] %>% summarySE(measurevar="length_mm")  # mean = 2.55471	stdev = 0.4976332	- highly variable relationship
Gurr2021_size.relationships[!is.na(Gurr2021_size.relationships$length.biov),] %>% summarySE(measurevar="length_mm")  # mean = 2.55471	stdev = 0.4976332	- highly variable relationship
Gurr2021_biovol.calc <- Gurr2021_biovol %>%
dplyr::filter(species %in% 'Ai') %>%  # call argopecten data (also has oyster data C. virginica)
dplyr::mutate(h = as.numeric(thickness_mm / 2)) %>% # divide by 2 fo the calculation of a single cap
dplyr::mutate(length.width.mean = ((length_mm+width_mm)/2)) %>%
dplyr::mutate(a = as.numeric(length.width.mean/2)) %>% # av of the length and width (slightly different) and get radius
dplyr::mutate(Cap_vol_L = ((1/6)*3.14*h)*(3*(a^2) + h^2)) %>% # volume of a spherical cap (1/6)πh(3a2 + h2)
dplyr::mutate(Biovol_estimate_mL3 = (Cap_vol_L*2)/1000)
Biov_true_vs_calculated <- Gurr2021_biovol.calc %>%
dplyr::filter(Timepoint %in% 'pre-deployment') %>%  # no biovolume measurements taken at post deployment
ggplot(aes(x=pre_biovolume_mL, y=Biovol_estimate_mL3)) + # , color = as.factor(site))
geom_point() +
xlab("biovolume_KNOWN") +
ylab("boivolume_CalcVCAP") +
geom_smooth(method='lm', formula= y~x) +
theme_bw()
Biov_true_vs_calculated
# since we only have shell length, what is the average relationship of length to width and thickness to generate volume?
Gurr2021_size.relationships <- Gurr2021_biovol %>%
dplyr::filter(species %in% 'Ai') %>%
dplyr::select(c('pre_biovolume_mL', 'length_mm', 'width_mm', 'thickness_mm')) %>%
dplyr::mutate(length.biov = (length_mm/pre_biovolume_mL)) %>%
dplyr::mutate(length.width = (length_mm/width_mm)) %>%
dplyr::mutate(length.thick = (length_mm/thickness_mm))
length_width <- Gurr2021_size.relationships %>%
ggplot(aes(x=length_mm, y=width_mm)) + # , color = as.factor(site))
geom_point() +
xlab("length (mm)") +
ylab("width (mm)") +
geom_smooth(method='lm', formula= y~x) +
theme_bw()
length_thickness <- Gurr2021_size.relationships %>%
ggplot(aes(x=length_mm, y=thickness_mm)) + # , color = as.factor(site))
geom_point() +
xlab("length (mm)") +
ylab("shell thickness (mm)") +
geom_smooth(method='lm', formula= y~x) +
theme_bw()
ggarrange(length_width, length_thickness)
length_thickness <- Gurr2021_size.relationships %>%
dplyr::filter(thickness_mm > 50) %>%
ggplot(aes(x=length_mm, y=thickness_mm)) + # , color = as.factor(site))
geom_point() +
xlab("length (mm)") +
ylab("shell thickness (mm)") +
geom_smooth(method='lm', formula= y~x) +
theme_bw()
length_width <- Gurr2021_size.relationships %>%
dplyr::filter(thickness_mm > 50) %>%
ggplot(aes(x=length_mm, y=width_mm)) + # , color = as.factor(site))
geom_point() +
xlab("length (mm)") +
ylab("width (mm)") +
geom_smooth(method='lm', formula= y~x) +
theme_bw()
ggarrange(length_width, length_thickness)
length_width <- Gurr2021_size.relationships %>%
dplyr::filter(!thickness_mm > 50) %>%
ggplot(aes(x=length_mm, y=width_mm)) + # , color = as.factor(site))
geom_point() +
xlab("length (mm)") +
ylab("width (mm)") +
geom_smooth(method='lm', formula= y~x) +
theme_bw()
length_thickness <- Gurr2021_size.relationships %>%
dplyr::filter(!thickness_mm > 50) %>%
ggplot(aes(x=length_mm, y=thickness_mm)) + # , color = as.factor(site))
geom_point() +
xlab("length (mm)") +
ylab("shell thickness (mm)") +
geom_smooth(method='lm', formula= y~x) +
theme_bw()
ggarrange(length_width, length_thickness)
Length.Width <- Gurr2021_size.relationships[!is.na(Gurr2021_size.relationships$length.width),] %>%
dplyr::filter(!thickness_mm > 50) %>%
summarySE(measurevar="length.width")  # mean = 0.9387522	stdev = 0.02717396	- consistent relationship
Length.Width
length_width <- Gurr2021_size.relationships %>%
dplyr::filter(!thickness_mm > 50) %>%
ggplot(aes(x=length_mm, y=width_mm)) + # , color = as.factor(site))
geom_point() +
xlab("length (mm)") +
ylab("width (mm)") +
ggtitle("Length*0.9385083 == width")
length_width <- Gurr2021_size.relationships %>%
dplyr::filter(!thickness_mm > 50) %>%
ggplot(aes(x=length_mm, y=width_mm)) + # , color = as.factor(site))
geom_point() +
xlab("length (mm)") +
ylab("width (mm)") +
ggtitle("Length*0.9385083 == width") +
geom_smooth(method='lm', formula= y~x) +
theme_bw()
length_width
Length.Thickness <- Gurr2021_size.relationships[!is.na(Gurr2021_size.relationships$length.thick),] %>%
dplyr::filter(!thickness_mm > 50) %>%
summarySE(measurevar="length.thick")  # mean = 2.487012	stdev = 0.2249636	- highly variable relationship
Length.Thickness
length_width <- Gurr2021_size.relationships %>%
dplyr::filter(!thickness_mm > 50) %>%
ggplot(aes(x=length_mm, y=width_mm)) + # , color = as.factor(site))
geom_point() +
xlab("length (mm)") +
ylab("width (mm)") +
ggtitle("Length * 0.94(+/- 0.2 SD) = Width") +
geom_smooth(method='lm', formula= y~x) +
theme_bw()
Length.Thickness <- Gurr2021_size.relationships[!is.na(Gurr2021_size.relationships$length.thick),] %>%
dplyr::filter(!thickness_mm > 50) %>%
summarySE(measurevar="length.thick")  # mean = 2.487012	stdev = 0.2249636	- highly variable relationship
Length.Thickness
length_thickness <- Gurr2021_size.relationships %>%
dplyr::filter(!thickness_mm > 50) %>%
ggplot(aes(x=length_mm, y=thickness_mm)) + # , color = as.factor(site))
geom_point() +
xlab("length (mm)") +
ggtitle("Length / 2.5(+/- 0.2 SD) = Shell thickness") +
ylab("shell thickness (mm)") +
geom_smooth(method='lm', formula= y~x) +
theme_bw()
ggarrange(length_width, length_thickness)
Biov_true_vs_calculated <- Gurr2021_biovol.calc %>%
dplyr::filter(Timepoint %in% 'pre-deployment') %>%  # no biovolume measurements taken at post deployment
ggplot(aes(x=pre_biovolume_mL, y=Biovol_estimate_mL3)) + # , color = as.factor(site))
geom_point() +
xlab("biovolume_KNOWN") +
ylab("boivolume_CalcVCAP") +
geom_smooth(method='lm', formula= y~x) +
theme_bw()
Biov_true_vs_calculated
# volume of a spherical cap (1/3)πh2(3R - h) or (1/6)πh(3a2 + h2)
# h = height (for a scallop is 1/2*shell thickness)
# a = radius from the cap bottom (for scallop shell is 1/2*length from hinge)
# R = radius from the center of the sphere - not applicable for the known measurments of the scallop
Reference_resp_sizeOM <- Reference_resp_size[!is.na(Reference_resp_size$Biovolume_g_in_sw),] %>%
dplyr::filter(!Biovolume_g_in_sw %in% '<add here>') %>%
dplyr::mutate(Length_mm = as.numeric(Length_um/1000)) %>%
dplyr::select(c('Date','pH','Length_mm','Biovolume_g_in_sw')) %>%
dplyr::mutate(Thickness_mm_estimate = (1/2.5)*Length_mm) %>% # from data taken in Gurr et al. 2021 (adult A.irradians)
dplyr::mutate(h = as.numeric(Thickness_mm_estimate / 2)) %>% # divide by 2 fo the calculation of a single cap
dplyr::mutate(a = as.numeric((Length_mm)/2)) %>% # note the length is 0.94 of the width in adult scallops (Gurr et al. 2021 data)
dplyr::mutate(Cap_vol_L = ((1/6)*3.14*h)*(3*(a^2) + h^2)) %>%
dplyr::mutate(Biovol_estimate_mL3 = (Cap_vol_L*2)/1000)
# colnames(Reference_resp_sizeOM)
Biov_length_regression <- Reference_resp_sizeOM %>%
ggplot(aes(x=as.numeric(Biovolume_g_in_sw), y=as.numeric(Biovol_estimate_mL3))) + # color = as.factor(pH))) +
geom_point() +
xlab("biovolume_KNOWN") +
ylab("boivolume_CalcVCAP") +
geom_smooth(method='lm', formula= y~x) +
theme_bw()
Biov_length_regression
# volume of a spherical cap (1/3)πh2(3R - h) or (1/6)πh(3a2 + h2)
# h = height (for a scallop is 1/2*shell thickness)
# a = radius from the cap bottom (for scallop shell is 1/2*length from hinge)
# R = radius from the center of the sphere - not applicable for the known measurments of the scallop
Reference_resp_sizeOM <- Reference_resp_size[!is.na(Reference_resp_size$Biovolume_g_in_sw),] %>%
dplyr::filter(!Biovolume_g_in_sw %in% '<add here>') %>%
dplyr::mutate(Length_mm = as.numeric(Length_um/1000)) %>%
dplyr::select(c('Date','pH','Length_mm','Biovolume_g_in_sw')) %>%
dplyr::mutate(Thickness_mm_estimate = Length_mm / 2.5) %>% # from data taken in Gurr et al. 2021 (adult A.irradians)
dplyr::mutate(h = as.numeric(Thickness_mm_estimate / 2)) %>% # divide by 2 fo the calculation of a single cap
dplyr::mutate(a = as.numeric((Length_mm)/2)) %>% # note the length is 0.94 of the width in adult scallops (Gurr et al. 2021 data)
dplyr::mutate(Cap_vol_L = ((1/6)*3.14*h)*(3*(a^2) + h^2)) %>%
dplyr::mutate(Biovol_estimate_mL3 = (Cap_vol_L*2)/1000)
# colnames(Reference_resp_sizeOM)
Biov_length_regression <- Reference_resp_sizeOM %>%
ggplot(aes(x=as.numeric(Biovolume_g_in_sw), y=as.numeric(Biovol_estimate_mL3))) + # color = as.factor(pH))) +
geom_point() +
xlab("biovolume_KNOWN") +
ylab("boivolume_CalcVCAP") +
geom_smooth(method='lm', formula= y~x) +
theme_bw()
Biov_length_regression
Reference_resp_sizeOM
# colnames(Reference_resp_sizeOM)
Biov_actual_Vcap <- Reference_resp_sizeOM %>%
ggplot(aes(x=as.numeric(Biovolume_g_in_sw), y=as.numeric(Biovol_estimate_mL3))) + # color = as.factor(pH))) +
geom_point() +
xlab("biovolume_KNOWN") +
ylab("boivolume_CalcVCAP") +
geom_smooth(method='lm', formula= y~x) +
theme_bw()
# colnames(Reference_resp_sizeOM)
Biov_actual_Vcap <- Reference_resp_sizeOM %>%
ggplot(aes(x=as.numeric(Biovolume_g_in_sw), y=as.numeric(Biovol_estimate_mL3))) + # color = as.factor(pH))) +
geom_point() +
xlab("biovolume_KNOWN") +
ylab("boivolume_CalcVCAP") +
ggtitle("Biovolume actual vs. Vcap estimated") +
geom_smooth(method='lm', formula= y~x) +
theme_bw()
Biov_length3_regression <- Reference_resp_sizeOM %>%
dplyr::mutate(length_cubed = Length_mm^3) %>%
ggplot(aes(x=as.numeric(Biovolume_g_in_sw), y=as.numeric(length_cubed))) + # color = as.factor(pH))) +
geom_point() +
xlab("biovolume_KNOWN") +
ylab("length^3") +
ggtitle("Biovolume actual vs. length^3") +
geom_smooth(method='lm', formula= y~x) +
theme_bw()
ggarrange(Biov_actual_Vcap, Biov_length3_regression)
Biov_length3_regression <- Reference_resp_sizeOM %>%
dplyr::mutate(length_cubed = (Length_mm^3)/1000 ) %>%
ggplot(aes(x=as.numeric(Biovolume_g_in_sw), y=as.numeric(length_cubed))) + # color = as.factor(pH))) +
geom_point() +
xlab("biovolume_KNOWN") +
ylab("length^3") +
ggtitle("Biovolume actual vs. length^3") +
geom_smooth(method='lm', formula= y~x) +
theme_bw()
Biov_length3_regression <- Reference_resp_sizeOM %>%
dplyr::mutate(length_cubed = (Length_mm^3)/1000 ) %>%
ggplot(aes(x=as.numeric(Biovolume_g_in_sw), y=as.numeric(length_cubed))) + # color = as.factor(pH))) +
geom_point() +
xlab("biovolume_KNOWN") +
ylab("length^3") +
ggtitle("Biovolume actual vs. length^3/1000") +
geom_smooth(method='lm', formula= y~x) +
theme_bw()
ggarrange(Biov_actual_Vcap, Biov_length3_regression)
Biov_length3_regression <- Reference_resp_sizeOM %>%
dplyr::mutate(length_cubed = (Length_mm^3)) %>%
ggplot(aes(x=as.numeric(Biovolume_g_in_sw), y=as.numeric(length_cubed))) + # color = as.factor(pH))) +
geom_point() +
xlab("biovolume_KNOWN") +
ylab("length^3") +
ggtitle("Biovolume actual vs. length^3/1000") +
geom_smooth(method='lm', formula= y~x) +
theme_bw()
Biov_length3_regression <- Reference_resp_sizeOM %>%
dplyr::mutate(length_cubed = (Length_mm^3)) %>%
ggplot(aes(x=as.numeric(Biovolume_g_in_sw), y=as.numeric(length_cubed))) + # color = as.factor(pH))) +
geom_point() +
xlab("biovolume_KNOWN") +
ylab("length^3") +
ggtitle("Biovolume actual vs. length^3") +
geom_smooth(method='lm', formula= y~x) +
theme_bw()
ggarrange(Biov_actual_Vcap, Biov_length3_regression)
# LOAD PACKAGES :::::::::::::::::::::::::::::::::::::::::::::::::::::::
library(dplyr)
library(ggplot2)
library(forcats)
library(lme4)
library(lmerTest)
library(performance)
library(car)
library(kableExtra)
library(pander)
library(data.table)
library(Rmisc)
library(devtools)
library(ggpubr)
library(SciViews)
# SET WORKING DIRECTORY :::::::::::::::::::::::::::::::::::::::::::::::
setwd("C:/Users/samjg/Documents/Github_repositories/Airradians_multigen_OA/RAnalysis") # personal computer
# setwd("C:/Users/samjg/Documents/Github_repositories/Airradians_multigen_OA/RAnalysis") # Work computer
# LOAD DATA :::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
RR_master <- read.csv(file="Output/Respiration/Calculated_Resp_Master.csv", header=T) %>%
filter(!Food %in% 'unfed') %>% # omit low food trial data
filter(!Date %in% '8/30/2022') %>% # an F2 measurement
dplyr::mutate(resp_umol_L_hr_mg_WDW =
resp_umol_L_hr/as.numeric(whole_Dry_weight)) %>%  # call whole dry weight corrected MO2
dplyr::mutate(resp_umol_L_hr_mmLength =
resp_umol_L_hr/ (1000/Length_um))  %>% # call length corrected MO2
# unique(RR_master$Date) # "10/26/2021" "2/2/2022"   "3/1/2022"   "8/30/2022"  "9/14/2021"  "9/22/2022"  "9/30/2021"
dplyr::mutate(Age = case_when(Date == '9/14/2021'  ~ 50,
Date == '9/30/2021'  ~ 66,
Date == '10/26/2021'  ~ 92,
Date == '2/2/2022' ~ 191,
Date == '3/1/2022'  ~ 218,
Date == '9/22/2022'  ~ 423,
Date == '10/26/2022' ~ 457)) %>%
dplyr::mutate(Age = as.factor(Age)) %>%
dplyr::arrange(Age)
# View(RR_master)
