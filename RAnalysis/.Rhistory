size=0.4,
linetype = "dashed",
position = position_dodge(preserve = "single"))  +
facet_wrap(~Date)
print(F1_ER_plot)
F1_ER_plot <- F1_ER_master %>%
dplyr::filter(!ExcretionRate_umol_mL_hr_TDWbfactor >70) %>% # two extreme outlier values!
ggplot(aes(x = pCO2,
y = ExcretionRate_umol_mL_hr_TDWbfactor,
fill = pCO2)) +
geom_boxplot(alpha = 0.5, # color hue
width=0.6, # boxplot width
outlier.size=0, # make outliers small
position = position_dodge(preserve = "single")) +
geom_point(pch = 19,
position = position_jitterdodge(0.01),
size=1) +
scale_fill_manual(values=c("forestgreen","orange")) +
theme_classic() +
ggtitle("F1 Scallops: Excretion rate TDW b factor norm (umol NH4 hr)") +
theme(
# legend.position="none", # if you want to omit the lengend!
axis.title.y=element_text(size=7),
axis.title.x=element_blank(),
axis.text.x=element_blank()) +
stat_summary(fun.y=mean,
geom = "errorbar",
aes(ymax = ..y.., ymin = ..y..),
width = 0.6,
size=0.4,
linetype = "dashed",
position = position_dodge(preserve = "single"))  +
facet_wrap(~Date)
print(F1_ER_plot)
pdf("C:/Users/samjg/Documents/Github_repositories/Airradians_multigen_OA/RAnalysis/Output/ExcretionRates/F1/F1_ER_Boxplor_TDWbfactor.csv")
print(F1_ER_plot)
dev.off()
pdf("C:/Users/samjg/Documents/Github_repositories/Airradians_multigen_OA/RAnalysis/Output/ExcretionRates/F2/F2_ER_Boxplor_TDWbfactor.csv")
print(F2_ER_plot)
dev.off()
F2_ER_plot <- F2_ER_master %>%
dplyr::filter(!ExcretionRate_umol_mL_hr_TDWbfactor >40) %>% # one extreme outlier value!
ggplot(aes(x = pCO2,
y = ExcretionRate_umol_mL_hr_TDWbfactor,
fill = pCO2)) +
geom_boxplot(alpha = 0.5, # color hue
width=0.6, # boxplot width
outlier.size=0, # make outliers small
position = position_dodge(preserve = "single")) +
geom_point(pch = 19,
position = position_jitterdodge(0.01),
size=1) +
scale_fill_manual(values=c("forestgreen","orange", "purple")) +
theme_classic() +
theme(
# legend.position="none", # if you want to omit the lengend!
axis.title.y=element_text(size=7),
axis.title.x=element_blank(),
axis.text.x=element_blank()) +
stat_summary(fun.y=mean,
geom = "errorbar",
aes(ymax = ..y.., ymin = ..y..),
width = 0.6,
size=0.4,
linetype = "dashed",
position = position_dodge(preserve = "single")) # no facet
F2_ER_plot
F2_ER_plot <- F2_ER_master %>%
dplyr::filter(!ExcretionRate_umol_mL_hr_TDWbfactor >40) %>% # one extreme outlier value!
ggplot(aes(x = as.factor(Date),
y = ExcretionRate_umol_mL_hr_TDWbfactor,
fill = pCO2)) +
geom_boxplot(alpha = 0.5, # color hue
width=0.6, # boxplot width
outlier.size=0, # make outliers small
position = position_dodge(preserve = "single")) +
geom_point(pch = 19,
position = position_jitterdodge(0.01),
size=1) +
scale_fill_manual(values=c("forestgreen","orange", "purple")) +
theme_classic() +
theme(
# legend.position="none", # if you want to omit the lengend!
axis.title.y=element_text(size=7),
axis.title.x=element_blank(),
axis.text.x=element_blank()) +
stat_summary(fun.y=mean,
geom = "errorbar",
aes(ymax = ..y.., ymin = ..y..),
width = 0.6,
size=0.4,
linetype = "dashed",
position = position_dodge(preserve = "single")) # no facet
F2_ER_plot
F2_ER_plot <- F2_ER_master %>%
F2_ER_plot <- F2_ER_master %>%
dplyr::filter(!ExcretionRate_umol_mL_hr_TDWbfactor >40) %>% # one extreme outlier value!
ggplot(aes(x = as.factor(Date),
y = ExcretionRate_umol_mL_hr_TDWbfactor,
fill = pCO2)) +
geom_boxplot(alpha = 0.5, # color hue
width=0.6, # boxplot width
outlier.size=0, # make outliers small
position = position_dodge(preserve = "single")) +
geom_point(pch = 19,
position = position_jitterdodge(0.01),
size=1) +
scale_fill_manual(values=c("forestgreen","orange", "purple")) +
theme_classic() +
theme(
# legend.position="none", # if you want to omit the lengend!
axis.title.y=element_text(size=7),
axis.title.x=element_text(size=7),
axis.text.x=element_text(size=7)) +
stat_summary(fun.y=mean,
geom = "errorbar",
aes(ymax = ..y.., ymin = ..y..),
width = 0.6,
size=0.4,
linetype = "dashed",
position = position_dodge(preserve = "single")) # no facet
F2_ER_plot
F2_ER_plot <- F2_ER_master %>%
dplyr::filter(!ExcretionRate_umol_mL_hr_TDWbfactor >40) %>% # one extreme outlier value!
ggplot(aes(x = as.factor(Date),
y = ExcretionRate_umol_mL_hr_TDWbfactor,
fill = pCO2)) +
geom_boxplot(alpha = 0.5, # color hue
width=0.6, # boxplot width
outlier.size=0, # make outliers small
position = position_dodge(preserve = "single")) +
geom_point(pch = 19,
position = position_jitterdodge(0.01),
size=1) +
scale_fill_manual(values=c("forestgreen","orange", "purple")) +
theme_classic() +
theme(
# legend.position="none", # if you want to omit the lengend!
axis.title.y=element_text(size=7),
axis.title.x=element_text(size=7),
axis.text.x=element_text(size=7)) +
stat_summary(fun.y=mean,
geom = "errorbar",
aes(ymax = ..y.., ymin = ..y..),
width = 0.6,
size=0.4,
linetype = "dashed",
position = position_dodge(preserve = "single")) # no facet
F2_ER_plot
ggarrange(F2_ER_plot_facetted, F2_ER_plot, ncol = 1, nrow = 2)
# output the plot
library(ggpubr)
ggarrange(F2_ER_plot_facetted, F2_ER_plot, ncol = 1, nrow = 2)
F2_ER_plot_facetted <- F2_ER_master %>%
dplyr::filter(!ExcretionRate_umol_mL_hr_TDWbfactor >40) %>% # one extreme outlier value!
ggplot(aes(x = pCO2,
y = ExcretionRate_umol_mL_hr_TDWbfactor,
fill = pCO2)) +
geom_boxplot(alpha = 0.5, # color hue
width=0.6, # boxplot width
outlier.size=0, # make outliers small
position = position_dodge(preserve = "single")) +
geom_point(pch = 19,
position = position_jitterdodge(0.01),
size=1) +
scale_fill_manual(values=c("forestgreen","orange", "purple")) +
theme_classic() +
ggtitle("F2 Scallops: Excretion rate TDW b factor norm (umol NH4 hr)") +
theme(
# legend.position="none", # if you want to omit the lengend!
axis.title.y=element_text(size=7),
axis.title.x=element_blank(),
axis.text.x=element_blank()) +
stat_summary(fun.y=mean,
geom = "errorbar",
aes(ymax = ..y.., ymin = ..y..),
width = 0.6,
size=0.4,
linetype = "dashed",
position = position_dodge(preserve = "single"))  +
facet_wrap(~Date)
ggarrange(F2_ER_plot_facetted, F2_ER_plot, ncol = 1, nrow = 2)
pdf(paste0("C:/Users/samjg/Documents/Github_repositories/Airradians_multigen_OA/RAnalysis/Output/ExcretionRates/ER_Boxplots_TDWbfactor.pdf"), width = 7, height= 6)
ggarrange(F2_ER_plot_facetted, F2_ER_plot, ncol = 1, nrow = 2)
dev.off()
# output the plot
pdf(paste0("C:/Users/samjg/Documents/Github_repositories/Airradians_multigen_OA/RAnalysis/Output/ExcretionRates/F2/F2_ER_Boxplor_TDWbfactor.pdf"), width = 7, height= 6)
ggarrange(F2_ER_plot_facetted, F2_ER_plot, ncol = 1, nrow = 2)
dev.off()
F1_ER_plot_facetted <- F1_ER_master %>%
dplyr::filter(!ExcretionRate_umol_mL_hr_TDWbfactor >70) %>% # two extreme outlier values!
ggplot(aes(x = pCO2,
y = ExcretionRate_umol_mL_hr_TDWbfactor,
fill = pCO2)) +
geom_boxplot(alpha = 0.5, # color hue
width=0.6, # boxplot width
outlier.size=0, # make outliers small
position = position_dodge(preserve = "single")) +
geom_point(pch = 19,
position = position_jitterdodge(0.01),
size=1) +
scale_fill_manual(values=c("forestgreen","orange")) +
theme_classic() +
ggtitle("F1 Scallops: Excretion rate TDW b factor norm (umol NH4 hr)") +
theme(
# legend.position="none", # if you want to omit the lengend!
axis.title.y=element_text(size=7),
axis.title.x=element_blank(),
axis.text.x=element_blank()) +
stat_summary(fun.y=mean,
geom = "errorbar",
aes(ymax = ..y.., ymin = ..y..),
width = 0.6,
size=0.4,
linetype = "dashed",
position = position_dodge(preserve = "single"))  +
facet_wrap(~Date)
F1_ER_plot_facetted
F1_ER_plot <- F1_ER_master %>%
dplyr::filter(!ExcretionRate_umol_mL_hr_TDWbfactor >40) %>% # one extreme outlier value!
ggplot(aes(x = as.factor(Date),
y = ExcretionRate_umol_mL_hr_TDWbfactor,
fill = pCO2)) +
geom_boxplot(alpha = 0.5, # color hue
width=0.6, # boxplot width
outlier.size=0, # make outliers small
position = position_dodge(preserve = "single")) +
geom_point(pch = 19,
position = position_jitterdodge(0.01),
size=1) +
scale_fill_manual(values=c("forestgreen","orange", "purple")) +
theme_classic() +
theme(
# legend.position="none", # if you want to omit the lengend!
axis.title.y=element_text(size=7),
axis.title.x=element_text(size=7),
axis.text.x=element_text(size=7)) +
stat_summary(fun.y=mean,
geom = "errorbar",
aes(ymax = ..y.., ymin = ..y..),
width = 0.6,
size=0.4,
linetype = "dashed",
position = position_dodge(preserve = "single")) # no facet
ggarrange(F1_ER_plot_facetted, F1_ER_plot, ncol = 1, nrow = 2)
# output the plot
pdf(paste0("C:/Users/samjg/Documents/Github_repositories/Airradians_multigen_OA/RAnalysis/Output/ExcretionRates/F1/F1_ER_Boxplor_TDWbfactor.pdf"), width = 7, height= 6)
ggarrange(F1_ER_plot_facetted, F1_ER_plot, ncol = 1, nrow = 2)
dev.off()
library(devtools) # devtools::install_github # use devtools to instlal github link
library(LoLinR) # install_github('colin-olito/LoLinR') # install LoLinR from github
library(dplyr)
library(lubridate)
library(rMR)
library(dplyr)
library(stringr)
library(rlang)
library(ggplot2)
library(ggfortify)
library(DESeq2)
library(devtools)
library(ggbiplot)
library(VennDiagram)# venn diagrams
library(eulerr) #venn diagrams -  check out the R shiny app (http://eulerr.co/)
# set wd
knitr::opts_knit$set(root.dir = 'C:/Users/samjg/Documents/Github_repositories/Airradians_multigen_OA/RAnalysis')
getwd()
Biodeposition    <- read.csv("Output/Biodeposition/Biodeposition_master_F2.csv", header = T)
RespirationRates <- read.csv(file="Output/Respiration/F2_RR_calc_master.csv", header=T)
ExcretionRates   <- read.csv(file="Output/ExcretionRates/F2/F2_ExcretionRates_master.csv", header=T)
# biodep
Biodeposition_adj    <- Biodeposition %>%
dplyr::select(-c(X, tank_ID.y)) %>%
dplyr::rename(tank_ID = tank_ID.x) %>%
dplyr::mutate(Date = format(strptime(Date, format = "%Y%m%d"), "%m/%d/%Y")) %>% # format to mm/dd/yyy as RR dataset
dplyr::mutate(Replicate = gsub("[^a-zA-Z]", "", tank_ID)) %>% # new replicate column - reflects RR dataset
dplyr::rename(Dry_Tissue_weight = animal_dry_weight_g) %>% # change name to match RR
dplyr::rename(Length_mm = animal_length_mm) %>% # change name to match RR
dplyr::rename(pH = treatment) %>% # rename to match
dplyr::select(-c(tank_ID, animal_number, initial_filter_weight_mg, dry_filter_weight_mg,ash_filter_weight_mg, inclubation_time_hours)) %>%
dplyr::mutate(Date = case_when(Date == "02/01/2023" ~ '1/31/2023',
Date == "02/24/2023" ~ '2/23/2023')) %>%
dplyr::select(-Length_mm) # lenngth is the exact same as the resp and Excretion data except diff sig figs and some missing
nrow(Biodeposition_adj) # nrow 42
# RR
RespirationRates_adj <- RespirationRates %>%
dplyr::filter(Date %in% c('1/31/2023','2/23/2023')) %>%
dplyr::mutate(Replicate =
gsub("[^a-zA-Z]", "", Chamber_tank)) %>% # new replicate column - reflects RR dataset
dplyr::select(c(Date,
Age,
pH,
pCO2,
Replicate,
Length_mm,
Dry_Tissue_weight,
resp_umol_hr_bFactorNormTDW.1g)) %>%
dplyr::rename(RR_resp_umol_hr_bfactorTDW =
resp_umol_hr_bFactorNormTDW.1g)
RespirationRates_adj$Dry_Tissue_weight <- as.numeric(RespirationRates_adj$Dry_Tissue_weight)
nrow(RespirationRates_adj) # 42
# ER
# note - we will bfctor and mean corret for TDW)
bTDW    <- 1.13 # added 12/19/22 after calculating a TDW ER specific b factor (review ER analysis script!)
ExcretionRates_adj  <- ExcretionRates  %>%
dplyr::mutate(Date = format(strptime(Date, format = "%Y%m%d"), "%m/%d/%Y")) %>% # format to mm/dd/yyy as RR dataset
dplyr::mutate(Date = case_when(Date == "01/31/2023" ~ '1/31/2023',
Date == "02/23/2023" ~ '2/23/2023')) %>%
dplyr::mutate(ExcretionRate_mg_hr = ExcretionRate_ug_mL_hr/1000) %>%
dplyr::rename(ExcretionRate_umol_hr = ExcretionRate_umol_mL_hr) %>%
dplyr::mutate(ExcretionRate_mg_hr_bFactorNormTDW =
(ExcretionRate_mg_hr)*((1/Dry_Tissue_weight)^bTDW)) %>% # TDW b factor - mg
dplyr::mutate(ExcretionRate_umol_hr_bFactorNormTDW =
(ExcretionRate_umol_hr)*((1/Dry_Tissue_weight)^bTDW)) %>% # TDW b factor - umol
dplyr::mutate(Length_mm = as.numeric(Length_um / 1000)) %>% # Length_mm matched biodep and RR
dplyr::select(c(Date,
pH,
Replicate,
Chamber_tank,
Length_um,
Dry_Tissue_weight,
ExcretionRate_mg_hr_bFactorNormTDW,
ExcretionRate_umol_hr_bFactorNormTDW))
ExcretionRates
s
# ER
# note - we will bfctor and mean corret for TDW)
bTDW    <- 1.11 # added 12/19/22 after calculating a TDW ER specific b factor (review ER analysis script!)
ExcretionRates_adj  <- ExcretionRates  %>%
dplyr::mutate(Date = format(strptime(Date, format = "%Y%m%d"), "%m/%d/%Y")) %>% # format to mm/dd/yyy as RR dataset
dplyr::mutate(Date = case_when(Date == "01/31/2023" ~ '1/31/2023',
Date == "02/23/2023" ~ '2/23/2023')) %>%
dplyr::mutate(ExcretionRate_mg_hr = ExcretionRate_ug_mL_hr/1000) %>%
dplyr::rename(ExcretionRate_umol_hr = ExcretionRate_umol_mL_hr) %>%
dplyr::mutate(ExcretionRate_mg_hr_bFactorNormTDW =
(ExcretionRate_mg_hr)*((1/Dry_Tissue_weight)^bTDW)) %>% # TDW b factor - mg
dplyr::mutate(ExcretionRate_umol_hr_bFactorNormTDW =
(ExcretionRate_umol_hr)*((1/Dry_Tissue_weight)^bTDW)) %>% # TDW b factor - umol
dplyr::mutate(Length_mm = as.numeric(Length_um / 1000)) %>% # Length_mm matched biodep and RR
dplyr::select(c(Date,
pH,
Replicate,
Chamber_tank,
Length_um,
Dry_Tissue_weight,
ExcretionRate_mg_hr_bFactorNormTDW,
ExcretionRate_umol_mL_hr_TDWbfactor,
ExcretionRate_umol_hr_bFactorNormTDW))
ExcretionRates_adj  <- ExcretionRates  %>%
dplyr::mutate(Date = format(strptime(Date, format = "%Y%m%d"), "%m/%d/%Y")) %>% # format to mm/dd/yyy as RR dataset
dplyr::mutate(Date = case_when(Date == "01/31/2023" ~ '1/31/2023',
Date == "02/23/2023" ~ '2/23/2023')) %>%
dplyr::mutate(ExcretionRate_mg_hr = ExcretionRate_ug_mL_hr/1000) %>%
dplyr::rename(ExcretionRate_umol_hr = ExcretionRate_umol_mL_hr) %>%
dplyr::mutate(ExcretionRate_mg_hr_bFactorNormTDW =
(ExcretionRate_mg_hr)*((1/Dry_Tissue_weight)^bTDW)) %>% # TDW b factor - mg
dplyr::mutate(ExcretionRate_umol_hr_bFactorNormTDW =
(ExcretionRate_umol_hr)*((1/Dry_Tissue_weight)^bTDW)) %>% # TDW b factor - umol
dplyr::mutate(Length_mm = as.numeric(Length_um / 1000)) %>% # Length_mm matched biodep and RR
dplyr::select(c(Date,
pH,
Replicate,
Chamber_tank,
Length_um,
Dry_Tissue_weight,
ExcretionRate_mg_hr_bFactorNormTDW,
ExcretionRate_umol_mL_hr_TDWbfactor,
ExcretionRate_umol_hr_bFactorNormTDW))
ExcretionRates_adj
ExcretionRates_adj  <- ExcretionRates  %>%
dplyr::mutate(Date = format(strptime(Date, format = "%Y%m%d"), "%m/%d/%Y")) %>% # format to mm/dd/yyy as RR dataset
dplyr::mutate(Date = case_when(Date == "01/31/2023" ~ '1/31/2023',
Date == "02/23/2023" ~ '2/23/2023')) %>%
dplyr::mutate(ExcretionRate_mg_hr = ExcretionRate_ug_mL_hr/1000) %>%
dplyr::rename(ExcretionRate_umol_hr = ExcretionRate_umol_mL_hr) %>%
dplyr::mutate(ExcretionRate_mg_hr_bFactorNormTDW =
(ExcretionRate_mg_hr)*((1/Dry_Tissue_weight)^bTDW)) %>% # TDW b factor - mg
dplyr::mutate(ExcretionRate_umol_hr_bFactorNormTDW =
(ExcretionRate_umol_hr)*((1/Dry_Tissue_weight)^bTDW)) %>% # TDW b factor - umol
dplyr::mutate(Length_mm = as.numeric(Length_um / 1000)) %>% # Length_mm matched biodep and RR
dplyr::select(c(Date,
pH,
Replicate,
Chamber_tank,
Length_um,
Dry_Tissue_weight,
ExcretionRate_mg_hr_bFactorNormTDW,
ExcretionRate_umol_hr_bFactorNormTDW))
# sanity check before we merge
nrow(ExcretionRates_adj)          == (nrow(RespirationRates_adj)  + nrow(Biodeposition_adj)) / 2 # should be TRUE
unique(ExcretionRates_adj$Date)   == unique(RespirationRates_adj$Date) # should be TRUE
unique(RespirationRates_adj$Date) ==  unique(Biodeposition_adj$Date)  # should be TRUE
Biodeposition_adj$uniqueID <- paste(Biodeposition_adj$Date,
Biodeposition_adj$pH,
Biodeposition_adj$Dry_Tissue_weight,
sep = '_')
RespirationRates_adj$uniqueID <- paste(RespirationRates_adj$Date,
RespirationRates_adj$pH,
RespirationRates_adj$Dry_Tissue_weight,
sep = '_')
ExcretionRates_adj$uniqueID <- paste(ExcretionRates_adj$Date,
ExcretionRates_adj$pH,
ExcretionRates_adj$Dry_Tissue_weight,
sep = '_')
# btwn RR and ER
nrow(subset(ExcretionRates_adj,
!(uniqueID %in% RespirationRates_adj$uniqueID))) # no discrepancies btwn files (yay!)
# now btwn RR and biodep
nrow(subset(RespirationRates_adj,
!(uniqueID %in% Biodeposition_adj$uniqueID))) # no discrepancies btwn files (yay!)
# merge RR and ER - check the number of rows == 42
RR_ER_merge <- merge(RespirationRates_adj,ExcretionRates_adj) %>% dplyr::select(!pCO2)
# ommitted pCO2 because biodep has the correct micro symbol and is merged below
nrow(RR_ER_merge) # 42 - no rows lost!
# merge this data with the biodep - adjust the columns to be our master file!
F2_Masterfile <- merge(RR_ER_merge, Biodeposition_adj,
by = c('Date','uniqueID','Dry_Tissue_weight', 'Replicate', 'pH')) %>%
dplyr::select(c(Date,
Age,
pCO2,
pH,
Replicate,
Chamber_tank,
Length_mm,
Dry_Tissue_weight,
RR_resp_umol_hr_bfactorTDW,
ExcretionRate_umol_hr_bFactorNormTDW,
IER_correct,
IRR_correct,
OER_correct,
ORR_correct,
CR_correct,
FR_correct,
RR_correct,
p,
f,
i,
SE,
AR,
AE))
nrow(F2_Masterfile) # 42 rows - as expected!!!!!
write.csv(F2_Masterfile, "Output/F2_RR_ER_Biodep_master.csv")
F2_Masterfile$RR_Energy    <- (14.14*(F2_Masterfile$RR_resp_umol_hr_bfactorTDW))
F2_Masterfile$RR_Excretion <- (0.025*(F2_Masterfile$ExcretionRate_umol_hr_bFactorNormTDW))
F2_Masterfile$SfG <- (F2_Masterfile$AR -
(F2_Masterfile$RR_Energy+F2_Masterfile$RR_Excretion)
)
F2_Masterfile$pCO2 <- factor(F2_Masterfile$pCO2, levels= c('500 μatm','800 μatm','1200 μatm'))
SFG_F2 <- ggplot(data=F2_Masterfile, aes(x=pCO2, y=SfG, colour=pCO2)) +
scale_colour_manual(values=c("forestgreen","orange", "purple"))+
theme_classic() +
geom_boxplot(fill="white", outlier.colour=NA, position=position_dodge(width=0.9)) +
geom_point(position=position_jitterdodge()) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
theme(axis.text.x=element_blank(),axis.title.x=element_blank()) +
labs(title="Scope for Growth ", x ="Month", y = "Scope for Growth") +
facet_wrap(~Date)
SFG_F2             <- ggplot(data=F2_Masterfile, aes(x=pCO2, y=SfG, colour=pCO2)) +
scale_colour_manual(values=c("forestgreen","orange", "purple"))+
theme_classic() +
geom_boxplot(fill="white", outlier.colour=NA, position=position_dodge(width=0.9)) +
geom_point(position=position_jitterdodge()) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
theme(axis.text.x=element_blank(),axis.title.x=element_blank()) +
labs(title="Scope for Growth ", x ="Month", y = "Scope for Growth") +
facet_wrap(~Date)
print(SFG_F2)
F2_Masterfile
F2_Masterfile
F2_Masterfile$ExcretionRate_umol_hr_bFactorNormTDW
# following the Widdows and Johnson 1988 aper described above..
# Note- RR is in L O2 so we will multiply 20.33*1000 to account for 20.33 Joules per ml-1 O2
F2_Masterfile$RR_Energy_Widdows.1988     <- (20.33*F2_Masterfile$RR_resp_umol_hr_bfactorTDW)
F2_Masterfile$RR_Excretion_Widdows.1988  <- (19.4*F2_Masterfile$ExcretionRate_umol_hr_bFactorNormTDW)
F2_Masterfile$SfG_Widdows.1988           <- (
(F2_Masterfile$AR * (CR_correct*23)) -
(F2_Masterfile$RR_Energy_Widdows.1988 + F2_Masterfile$RR_Excretion_Widdows.1988)
)
F2_Masterfile$SfG_Widdows.1988           <- (
(F2_Masterfile$AR * (F2_Masterfile$CR_correct*23)) -
(F2_Masterfile$RR_Energy_Widdows.1988 + F2_Masterfile$RR_Excretion_Widdows.1988)
)
SFG_F2_Widdows1988 <- ggplot(data=F2_Masterfile, aes(x=pCO2, y=SfG_Widdows.1988, colour=pCO2)) +
scale_colour_manual(values=c("forestgreen","orange", "purple"))+
theme_classic() +
geom_boxplot(fill="white",
outlier.colour=NA,
position=position_dodge(width=0.9)) +
geom_point(position=position_jitterdodge()) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
theme(axis.text.x=element_blank(),axis.title.x=element_blank()) +
labs(title="Scope for Growth ", x ="Month", y = "Scope for Growth") +
facet_wrap(~Date)
SFG_F2_Widdows1988
SFG_F2_Widdows1988 <- ggplot(data=F2_Masterfile, aes(x=pCO2, y=SfG_Widdows.1988, colour=pCO2)) +
scale_colour_manual(values=c("forestgreen","orange", "purple"))+
theme_classic() +
geom_boxplot(fill="white",
outlier.colour=NA,
position=position_dodge(width=0.9)) +
geom_point(position=position_jitterdodge()) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
theme(axis.text.x=element_blank(),axis.title.x=element_blank()) +
labs(title="Scope for Growth (Widdows and Johnson 1988)",
x ="Month",
y = "Scope for Growth") +
facet_wrap(~Date)
ggarrange(SFG_F2, SFG_F2_Widdows1988)
ggarrange(SFG_F2, SFG_F2_Widdows1988, nrow = 2)
pdf("C:/Users/samjg/Documents/Github_repositories/Airradians_multigen_OA/RAnalysis/Output/F2_SFG.pdf")
ggarrange(SFG_F2, SFG_F2_Widdows1988, nrow = 2)
dev.off()
