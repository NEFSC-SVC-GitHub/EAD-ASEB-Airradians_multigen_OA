---
title: "Seawater Chemistry"
author: "Samuel Gurr"
date: "8/7/2024"
output: html_document
---

### SET UP
```{r setup, include=FALSE}

knitr::opts_chunk$set(echo = TRUE)
# SET WORKING DIRECTORY 
# knitr::opts_knit$set(root.dir = "C:/Users/katherine.mcfarland/Documents/GitHub/EAD-ASEB-Airradians_multigen_OA/larvae") # Katie's
knitr::opts_knit$set(root.dir = "C:/Users/samjg/Documents/Github_repositories/Airradians_multigen_OA/RAnalysis") # Sam's
#knitr::opts_knit$set(root.dir = "C:/Users/samuel.gurr/Documents/Github_repositories/EAD-ASEB-Airradians_multigen_OA/RAnalysis/") # Sam's work


```





```{r load data}
# install.packages('gcookbook')
# LOAD PACKAGES :::::::::::::::::::::::::::::::::::::::::::::::::::::::
library(dplyr)
library(ggplot2)
library(reshape2)
library(knitr)
library(kableExtra)
library(car)
library(gcookbook)

# LOAD DATA :::::::::::::::::::::::::::::::::::::::::::::::::::::::::::

# F1 
F1_chem_larvae     <- read.csv(file="Data/SeawaterChemistry/F1/F1_water_chemistry_raw_larvae.csv", header=TRUE) # load the chem data
F1_chem_spat.adult <- read.csv(file="Data/SeawaterChemistry/F1/F1_water_chemistry_raw.csv", header=TRUE) # load the chem data


# F2
F2_chem_pre        <- read.csv(file="Data/SeawaterChemistry/F2/F2_water_chemistry_pre_overwinter_raw.csv", header=TRUE) # load the chem data
F2_chem_post       <- read.csv(file="Data/SeawaterChemistry/F2/F2_water_chemistry_post_overwinter_raw.csv", header=TRUE) # load the chem data
# note the pthe pre post is abitrary - GEneveive left off on the cumulative doc at mid January 
# what this readlly representes is wehent DIC broke down, the second as -post; is when the DIC broke down 
# therefore she reports the TA pH TA DC and the DIC pH at the headers of all columns 

```


# MASTER FILE MERGE (rbind) datasets within generation

```{r F1 edit master file}
ncol(F1_chem_larvae) == ncol(F1_chem_spat.adult) # TRUE - same spreadsheet
colnames(F1_chem_larvae) == colnames(F1_chem_spat.adult) # TRUE - also the same

chem.MASTER <- rbind(F1_chem_larvae, F1_chem_spat.adult)

# NOTe: full carbonate chemistry was taken non-continuosly, call all rows that contain full carb

carbchem                <- chem.MASTER[!(is.na(chem.MASTER$War_out_DIC_pH)),] 
carbchem.flagged.DIC.TA <- subset(carbchem, (TCO2_mmol_kgSW > TA_mmol_kgSW)) # 13 rows flagged for DIC<TA
carbchem.flagged.odd    <- subset(carbchem, War_out_DIC_pH > 400) # 8 w/ high aragonite, next highest is 2.05

write.csv((rbind(carbchem.flagged.DIC.TA, carbchem.flagged.odd)), "C:/Users/samjg/Documents/Github_repositories/Airradians_multigen_OA/RAnalysis/Output/SeawaterChemistry/F1s/flagged_data.csv")

carbchem.MASTER         <- subset(carbchem, !(TCO2_mmol_kgSW > TA_mmol_kgSW)) %>% # DIC>TA omit
  dplyr::filter(War_out_DIC_pH < 3) %>% # omit these odd aragonite points
  dplyr::mutate(pCO2_treatment = 
                  case_when(Treatment == 8 ~ 'Low',
                            Treatment == 7.5 ~ 'Moderate',
                            Treatment == 7 ~ 'Severe'))

write.csv(carbchem.MASTER, "C:/Users/samjg/Documents/Github_repositories/Airradians_multigen_OA/RAnalysis/Output/SeawaterChemistry/F1s/master/CarbChem_master.csv")

```

## F2 master file 
* total 64 sampling dates over the course of the experiment from spat to adult stage - we dont need all of it though!
```{r F2 edit master file}
F2_chem_pre.OM <- F2_chem_pre %>% dplyr::mutate(Treatment = case_when(Replicate.color %in% 'green/purple' ~ 7.0,
                                          TRUE ~ Treatment)
                                               ) %>% 
                                  tidyr::drop_na(Wca_out)

F2_chem_pre.REP.SUMM <- F2_chem_pre.OM %>% dplyr::select(c(Date, Treatment)) %>% 
                       dplyr::group_by_all() %>% 
                       dplyr::summarise(n=n())

length(unique(F2_chem_pre.REP.SUMM$Date)) # 31 dates when measured over this period! 


View(F2_chem_post.OM)
F2_chem_post.OM <- F2_chem_post %>% 
                                  tidyr::drop_na(Temperature_spec_C)

F2_chem_post.REP.SUMM <- F2_chem_post.OM %>% dplyr::select(c(Date, Treatment)) %>% 
                       dplyr::group_by_all() %>% 
                       dplyr::summarise(n=n())

length(unique(F2_chem_post.REP.SUMM$Date)) # 33 dates when measured over this period! 


```
# PLOTS AND ANALYSIS - Aragonite saturation levels



```{r plotting}

# change to long format to properly facet
carbchem.MASTER_long <- carbchem.MASTER %>% 
                          dplyr::select(!c(Treatment,Replicate)) %>% 
                          dplyr::filter(!pCO2_treatment %in% 'Severe') %>% 
                          melt(id.vars=c('Date', 'Type', 'pCO2_treatment'))

carbchem.MASTER_long$value <- as.numeric(carbchem.MASTER_long$value) # make numeric

# aquire means by group for mean SE plotting by Date and treamtent
carbchem.MASTER_MEANS <- carbchem.MASTER_long %>% # calc means and standard error
                           na.omit() %>% 
                          dplyr::mutate(Date = 
                                          as.POSIXct(Date, format = "%m/%d/%Y"),
                                        Month = months(Date),
                                        Year  = year(Date)) %>% 
                           dplyr::group_by(Date, Type, pCO2_treatment, variable) %>% 
                           dplyr::summarise(mean = mean(value),
                                            sd   = sd(value),
                                            se   = sd/(sqrt(n())) )

                        
carbchem.MASTER_MEANS.MONTLY <-  carbchem.MASTER_long %>% # calc means and standard error
                                   na.omit() %>% 
                                  dplyr::filter(!Type %in% 'Larvae') %>% 
                                   dplyr::mutate(Date = 
                                        as.POSIXct(Date, format = "%m/%d/%Y"),
                                        Month = months(Date),
                                        Year  = year(Date)) %>% 
                                   dplyr::group_by(Month, Year, pCO2_treatment, variable) %>% 
                                   dplyr::summarise(mean = mean(value),
                                            sd   = sd(value),
                                            se   = sd/(sqrt(n())) ) %>% 
                                   dplyr::mutate(
                                     Month = as.integer(factor(Month, levels = month.name)),
                                     Month_Year = (paste0(Month,'/',Year)),
                                     Date = lubridate::my(Month_Year))




# plot em!
colnames(carbchem.MASTER) # target select

pd <- position_dodge(0.1) # adjust the jitter for the different treatments   


Larvae <- carbchem.MASTER_MEANS %>% 
  dplyr::filter(Type %in% 'Larvae') %>% 
  dplyr::filter(variable %in% (c('Temperature_bucket_C',
                                 'Salinity',
                                 'DO_mg_l',
                                 'pH',
                                 'pH_out',
                                 'TCO2_mmol_kgSW',
                                 'TA_mmol_kgSW',
                                 'War_out_DIC_pH',
                                 'Wca_out'))) %>% 
  ggplot(aes(x=Date, y=mean, shape=Type, colour=factor(pCO2_treatment))) + 
  geom_errorbar(aes(ymin=mean-se, ymax=mean+se), colour="black", width=.1, position=pd) +
  geom_line(position=pd) +
  scale_colour_manual(values = c("Low" = "forestgreen",
                                 "Moderate"="orange")) +
                                 # "Severe" = "purple")) +
  theme_classic() +
  geom_point(position=pd, size=2) +
  theme(axis.text.x = element_text(angle = 45, hjust=1, size = 5)) +
  #scale_y_continuous(expand = c(0, 0), limits = c(0, 300000)) +
  facet_wrap(~variable, scales = "free")



pdf("C:/Users/samjg/Documents/Github_repositories/Airradians_multigen_OA/RAnalysis/Output/SeawaterChemistry/F1s/plots/F1_larvae.pdf", width=12, height=8)
print(Larvae)
graphics.off()



Juvenile <- carbchem.MASTER_MEANS %>% 
  dplyr::filter(Type %in% 'Juveniles') %>% 
  dplyr::filter(variable %in% (c('Temperature_bucket_C',
                                 'Salinity',
                                 'DO_mg_l',
                                 'pH',
                                 'pH_out',
                                 'TCO2_mmol_kgSW',
                                 'TA_mmol_kgSW',
                                 'War_out_DIC_pH',
                                 'Wca_out'))) %>% 
  ggplot(aes(x=Date, y=mean, shape=Type, colour=factor(pCO2_treatment))) + 
  geom_errorbar(aes(ymin=mean-se, ymax=mean+se), colour="black", width=.1, position=pd) +
  geom_line(position=pd) +
  scale_colour_manual(values = c("Low" = "forestgreen",
                                 "Moderate"="orange")) +
                                 # "Severe" = "purple")) +
  theme_classic() +
  geom_point(position=pd, size=2) +
  theme(axis.text.x = element_text(angle = 45, hjust=1, size = 5)) +
  #scale_y_continuous(expand = c(0, 0), limits = c(0, 300000)) +
  facet_wrap(~variable, scales = "free")
print(Juvenile)

pdf("C:/Users/samjg/Documents/Github_repositories/Airradians_multigen_OA/RAnalysis/Output/SeawaterChemistry/F1s/plots/F1_juveniles.pdf", width=12, height=8)
print(Juvenile)
graphics.off()


Adult <- carbchem.MASTER_MEANS %>% 
  dplyr::filter(Type %in% 'Adults') %>% 
  dplyr::filter(pCO2_treatment %in% c("Low", "Moderate")) %>% 
  dplyr::filter(variable %in% (c('Temperature_bucket_C',
                                 'Salinity',
                                 'DO_mg_l',
                                 'pH',
                                 'pH_out',
                                 'TCO2_mmol_kgSW',
                                 'TA_mmol_kgSW',
                                 'War_out_DIC_pH',
                                 'Wca_out'))) %>% 
  ggplot(aes(x=Date, y=mean, shape=Type, colour=factor(pCO2_treatment))) + 
  geom_errorbar(aes(ymin=mean-se, ymax=mean+se), colour="black", width=.1, position=pd) +
  geom_line(position=pd) +
  scale_colour_manual(values = c("Low" = "forestgreen",
                                 "Moderate"="orange")) +
  theme_classic() +
  geom_point(position=pd, size=2) +
  theme(axis.text.x = element_text(angle = 45, hjust=1, size = 5)) +
  scale_x_date(date_labels="%b-%d",date_breaks  ="3 month")+
  #scale_y_continuous(expand = c(0, 0), limits = c(0, 300000)) +
  facet_wrap(~variable, scales = "free")
print(Adult)

pdf("C:/Users/samjg/Documents/Github_repositories/Airradians_multigen_OA/RAnalysis/Output/SeawaterChemistry/F1s/plots/F1_adults.pdf", width=12, height=8)
print(Adult)
graphics.off()




Ph_out_all <- as.data.frame(carbchem.MASTER_MEANS.MONTLY %>% 
                na.omit() %>% 
                # dplyr::filter(!Type %in% 'Larvae') %>carbchem.MASTER_MEANS.MONTLY% 
                dplyr::filter(pCO2_treatment %in% c("Low", "Moderate")) %>% 
                dplyr::filter(variable %in% c(
                                               'Temperature_bucket_C',
                                               'Salinity',
                                               # 'DO_mg_l',
                                               # 'pH',
                                               'pH_out',
                                               # 'TCO2_mmol_kgSW',
                                               # 'TA_mmol_kgSW',
                                               'War_out_DIC_pH',
                                               'Wca_out'
                                               ))
                                          )

ggplot(data= Ph_out_all, 
         aes(x=Date, 
             y=mean)) +
             # shape=Type, 
            # colour=factor(pCO2_treatment)))  +
  # stat_summary(geom = "line", fun.y = mean) +
  # stat_summary(geom = "ribbon", fun.data = mean_cl_normal, alpha = 0.3)
  geom_ribbon(aes(ymin = (mean - sd), 
                  ymax = (mean + sd),
                  fill=factor(pCO2_treatment)), alpha = 0.2) +
  geom_line(aes(y = mean - sd,
                colour=factor(pCO2_treatment)), 
            linetype = "solid") +
  geom_line(aes(y = mean + sd,
                colour=factor(pCO2_treatment)), 
            linetype = "solid") +
  #geom_line()  +
  scale_fill_manual(values=c("forestgreen", "orange"), name="fill") +
  scale_colour_manual(values = c("Low" = "forestgreen",
                                 "Moderate"="orange")) +
  theme_classic() +
  # geom_errorbar(aes(ymin=mean-se, ymax=mean+se), colour="black", width=.1, position=pd) +
  # geom_line(position=pd) +
  # scale_colour_manual(values = c("Low" = "forestgreen",
  #                                "Moderate"="orange")) +
  # theme_classic() +
  # geom_point(position=pd, size=2) +
  # theme(axis.text.x = element_text(angle = 45, hjust=1, size = 5)) +
  # scale_x_date(date_labels="%b-%d",date_breaks  ="3 month")+
  # #scale_y_continuous(expand = c(0, 0), limits = c(0, 300000)) +
  facet_wrap(~variable, scales = "free")
print(Adult)


```





# TABLE (all data)

```{r use dplyr to build chemistry table, include=FALSE}
carbchem.MASTER_MEANS <- carbchem.MASTER_long %>% # calc means and standard error
   na.omit() %>% 
   dplyr::group_by(Date, Type, pCO2_treatment, variable) %>% 
   dplyr::summarise(mean = mean(value),
                    sd   = sd(value),
                    se   = sd/(sqrt(n())) )

chem_meanDate <- carbchem.MASTER_MEANS %>% 
     na.omit() %>% 
   dplyr::group_by(pCO2_treatment, variable) %>% 
   dplyr::summarise(mean2 = mean(mean),
                    sd   = sd(mean),
                    se   = sd/(sqrt(n())) ,
                    n = n())

carbchem.MASTER_wideMEANS <- dcast(chem_meanDate, pCO2_treatment ~ variable, value.var="mean2")
carbchem.MASTER_wideStErr <- dcast(chem_meanDate, pCO2_treatment ~ variable, value.var="se")
carbchem.MASTER_wideN     <- dcast(chem_meanDate, pCO2_treatment ~ variable, value.var="n")

# final table

colnames(carbchem.MASTER_wideMEANS)
FINAL_TABLE                <- data.frame(matrix(nrow = nrow(carbchem.MASTER_wideMEANS), ncol = 1))

FINAL_TABLE$pCO2_Treatment <- carbchem.MASTER_wideMEANS$pCO2_treatment

FINAL_TABLE$Salinity       <-  paste( (paste( (signif(carbchem.MASTER_wideMEANS$Salinity, digits=3)),
                                     (signif(carbchem.MASTER_wideStErr$Salinity, digits=3)), sep=" ± ")),
                                     " (",
                                     carbchem.MASTER_wideN$Salinity,
                                     ")",
                                     sep = "")

FINAL_TABLE$pCO2           <-  paste( (paste( (signif(carbchem.MASTER_wideMEANS$xCO2_out._dry_at._1_atm_.ppm_.DIC_pH, digits=3)),
                                     (signif(carbchem.MASTER_wideStErr$xCO2_out._dry_at._1_atm_.ppm_.DIC_pH, digits=3)), sep=" ± ")),
                                     " (",
                                     carbchem.MASTER_wideN$xCO2_out._dry_at._1_atm_.ppm_.DIC_pH,
                                     ")",
                                     sep = "")

FINAL_TABLE$Temperature    <- paste( (paste( (signif(carbchem.MASTER_wideMEANS$Temperature_bucket_C, digits=3)),
                                     (signif(carbchem.MASTER_wideStErr$Temperature_bucket_C, digits=3)), sep=" ± ")),
                                     " (",
                                     carbchem.MASTER_wideN$Temperature_bucket_C,
                                     ")",
                                     sep = "")

FINAL_TABLE$pH             <- paste( (paste( (signif(carbchem.MASTER_wideMEANS$pH_out, digits=3)),
                                     (signif(carbchem.MASTER_wideStErr$pH_out, digits=3)), sep=" ± ")),
                                     " (",
                                     carbchem.MASTER_wideN$pH_out,
                                     ")",
                                     sep = "")

FINAL_TABLE$HCO3           <-  paste( (paste( (signif(carbchem.MASTER_wideMEANS$HCO3_out_mmol_kgSW, digits=3)),
                                     (signif(carbchem.MASTER_wideStErr$HCO3_out_mmol_kgSW, digits=3)), sep=" ± ")),
                                     " (",
                                     carbchem.MASTER_wideN$HCO3_out_mmol_kgSW,
                                     ")",
                                     sep = "")

FINAL_TABLE$CO3           <-  paste( (paste( (signif(carbchem.MASTER_wideMEANS$CO3_out_mmol_kgSW, digits=3)),
                                             "±",
                                     (signif(carbchem.MASTER_wideStErr$CO3_out_mmol_kgSW, digits=3)), sep="  ")),
                                     " (",
                                     carbchem.MASTER_wideN$CO3_out_mmol_kgSW,
                                     ")",
                                     sep = "")

FINAL_TABLE$TA             <- paste( (paste( (signif(carbchem.MASTER_wideMEANS$TA_mmol_kgSW, digits=3)),
                                     (signif(carbchem.MASTER_wideStErr$TA_mmol_kgSW, digits=3)), sep=" ± ")),
                                     " (",
                                     carbchem.MASTER_wideN$TA_mmol_kgSW,
                                     ")",
                                     sep = "")

FINAL_TABLE$Aragonite.Sat  <-  paste( (paste( (signif(carbchem.MASTER_wideMEANS$War_out_DIC_pH, digits=3)),
                                     (signif(carbchem.MASTER_wideStErr$War_out_DIC_pH, digits=3)), sep=" ± ")),
                                     " (",
                                     carbchem.MASTER_wideN$War_out_DIC_pH,
                                     ")",
                                     sep = "")

FINAL_TABLE                <- FINAL_TABLE[,-1] # view table
```


## knitR to print the table 
```{r lable output, echo=TRUE}
FINAL_TABLE %>%
  kbl(caption = "Table 1. Seawater chemistry") %>%
  kable_classic(full_width = T, html_font = "Cambria")
```


#### save data
```{r save tables, echo=TRUE}
# save output table
# write.table(chem_meanDate,"C:/Users/samjg/Documents/Github_repositories/Cvirginica_multistressor/RAnalysis/Output/Water_Chem/Chem.Table_sep.csv",sep=",", row.names=FALSE)  # write table to 
# write.table(FINAL_TABLE,"C:/Users/samjg/Documents/Github_repositories/Cvirginica_multistressor/RAnalysis/Output/Water_Chem/Chem.Table.csv",sep=",", row.names=FALSE)  # write table to 

```










# TABLE (all data)

```{r use dplyr to build chemistry table, include=FALSE}

# change to long format to properly facet
carbchem.MASTER_long <- carbchem.MASTER %>% 
  dplyr::select(!c(Treatment,Replicate)) %>% 
  melt(id.vars=c('Date', 'Type', 'pCO2_treatment'))

carbchem.MASTER_long$value <- as.numeric(carbchem.MASTER_long$value) # make numeric

carbchem.MASTER_MEANS <- carbchem.MASTER_long %>% # calc means and standard error
   na.omit() %>% 
   dplyr::group_by(Date, Type, pCO2_treatment, variable) %>% 
   dplyr::summarise(mean = mean(value),
                    sd   = sd(value),
                    se   = sd/(sqrt(n())) )

chem_meanDate <- carbchem.MASTER_MEANS %>% 
     na.omit() %>% 
   dplyr::group_by(pCO2_treatment, variable) %>% 
   dplyr::summarise(mean2 = mean(mean),
                    sd   = sd(mean),
                    se   = sd/(sqrt(n())) ,
                    n = n())

carbchem.MASTER_wideMEANS <- dcast(chem_meanDate, pCO2_treatment ~ variable, value.var="mean2")
carbchem.MASTER_wideStErr <- dcast(chem_meanDate, pCO2_treatment ~ variable, value.var="se")
carbchem.MASTER_wideN     <- dcast(chem_meanDate, pCO2_treatment ~ variable, value.var="n")

# final table

colnames(carbchem.MASTER_wideMEANS)
FINAL_TABLE                <- data.frame(matrix(nrow = nrow(carbchem.MASTER_wideMEANS), ncol = 1))

FINAL_TABLE$pCO2_Treatment <- carbchem.MASTER_wideMEANS$pCO2_treatment

FINAL_TABLE$Salinity       <-  paste( (paste( (signif(carbchem.MASTER_wideMEANS$Salinity, digits=3)),
                                     (signif(carbchem.MASTER_wideStErr$Salinity, digits=3)), sep=" ± ")),
                                     " (",
                                     carbchem.MASTER_wideN$Salinity,
                                     ")",
                                     sep = "")

FINAL_TABLE$pCO2           <-  paste( (paste( (signif(carbchem.MASTER_wideMEANS$xCO2_out._dry_at._1_atm_.ppm_.DIC_pH, digits=3)),
                                     (signif(carbchem.MASTER_wideStErr$xCO2_out._dry_at._1_atm_.ppm_.DIC_pH, digits=3)), sep=" ± ")),
                                     " (",
                                     carbchem.MASTER_wideN$xCO2_out._dry_at._1_atm_.ppm_.DIC_pH,
                                     ")",
                                     sep = "")

FINAL_TABLE$Temperature    <- paste( (paste( (signif(carbchem.MASTER_wideMEANS$Temperature_bucket_C, digits=3)),
                                     (signif(carbchem.MASTER_wideStErr$Temperature_bucket_C, digits=3)), sep=" ± ")),
                                     " (",
                                     carbchem.MASTER_wideN$Temperature_bucket_C,
                                     ")",
                                     sep = "")

FINAL_TABLE$pH             <- paste( (paste( (signif(carbchem.MASTER_wideMEANS$pH_out, digits=3)),
                                     (signif(carbchem.MASTER_wideStErr$pH_out, digits=3)), sep=" ± ")),
                                     " (",
                                     carbchem.MASTER_wideN$pH_out,
                                     ")",
                                     sep = "")

FINAL_TABLE$HCO3           <-  paste( (paste( (signif(carbchem.MASTER_wideMEANS$HCO3_out_mmol_kgSW, digits=3)),
                                     (signif(carbchem.MASTER_wideStErr$HCO3_out_mmol_kgSW, digits=3)), sep=" ± ")),
                                     " (",
                                     carbchem.MASTER_wideN$HCO3_out_mmol_kgSW,
                                     ")",
                                     sep = "")

FINAL_TABLE$CO3           <-  paste( (paste( (signif(carbchem.MASTER_wideMEANS$CO3_out_mmol_kgSW, digits=3)),
                                             "±",
                                     (signif(carbchem.MASTER_wideStErr$CO3_out_mmol_kgSW, digits=3)), sep="  ")),
                                     " (",
                                     carbchem.MASTER_wideN$CO3_out_mmol_kgSW,
                                     ")",
                                     sep = "")

FINAL_TABLE$TA             <- paste( (paste( (signif(carbchem.MASTER_wideMEANS$TA_mmol_kgSW, digits=3)),
                                     (signif(carbchem.MASTER_wideStErr$TA_mmol_kgSW, digits=3)), sep=" ± ")),
                                     " (",
                                     carbchem.MASTER_wideN$TA_mmol_kgSW,
                                     ")",
                                     sep = "")

FINAL_TABLE$Aragonite.Sat  <-  paste( (paste( (signif(carbchem.MASTER_wideMEANS$War_out_DIC_pH, digits=3)),
                                     (signif(carbchem.MASTER_wideStErr$War_out_DIC_pH, digits=3)), sep=" ± ")),
                                     " (",
                                     carbchem.MASTER_wideN$War_out_DIC_pH,
                                     ")",
                                     sep = "")

FINAL_TABLE                <- FINAL_TABLE[,-1] # view table
```


## knitR to print the table 
```{r lable output, echo=TRUE}
FINAL_TABLE %>%
  kbl(caption = "Table 1. Seawater chemistry") %>%
  kable_classic(full_width = T, html_font = "Cambria")
```


#### save data (food x OA manuscript)
```{r save tables, echo=TRUE}
# save output table
# write.table(chem_meanDate,"C:/Users/samjg/Documents/Github_repositories/Cvirginica_multistressor/RAnalysis/Output/Water_Chem/Chem.Table_sep.csv",sep=",", row.names=FALSE)  # write table to 
# write.table(FINAL_TABLE,"C:/Users/samjg/Documents/Github_repositories/Cvirginica_multistressor/RAnalysis/Output/Water_Chem/Chem.Table.csv",sep=",", row.names=FALSE)  # write table to 

```
