stat_summary(fun.y="mean",position = position_dodge2(width = 0.75)) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))+
labs(title="Age = 11 and 15 days", x ="pCO2 level", y = "Larvae size (Î¼m)")+
theme(axis.title.y = element_text(size = rel(1.3),
angle =90),
axis.title.x = element_text(size = rel(1.3),
angle = 0))+
theme(axis.text=element_text(size=12)) +
facet_wrap(~OA*Age)
p<-ggplot(data=data, aes(x=interval, y=OR, colour=Drug)) + geom_point() + geom_line()
p<-p+geom_ribbon(aes(ymin=data$lower, ymax=data$upper), linetype=2, alpha=0.1)
Survival_means_day1         <- Av_length.survival_dat %>%
dplyr::filter(Day == 1) %>%
na.omit() %>%
dplyr::group_by(Day, OA, Salinity, Temp) %>%
dplyr::summarise(mean_survival = mean(Survival),
n           = n(),
sd_survival   = sd(Survival),
se_survival   = sd_survival/(sqrt(n)))
Survival_all_MeanSE_plot_Day1 <- Survival_means_day1 %>%
dplyr::mutate(AllTreat = as.factor(paste(OA, Salinity, Temp, sep = '_'))) %>%
ggplot(aes(x = as.numeric(Day),
y = mean_survival,
group = AllTreat,
colour=fct_relevel(Salinity, c("Low", "High")),
linetype = Temp)) +
geom_point(aes(colour = fct_relevel(Salinity, c("Low", "High")),
shape = fct_relevel(OA, c("Low", "High"))),
width = 0.5,
position = "dodge2") +
geom_line(aes(x = as.numeric(Day),
y=mean_survival,
colour=fct_relevel(Salinity, c("Low", "High")),
linetype = Temp)) +
geom_errorbar(aes(ymin = mean_survival - se_survival,
ymax = mean_survival + se_survival),
width = 0.5, position= "dodge2") +
theme_classic() +
facet_wrap(~(fct_relevel(OA, c("Low", "High"))))
Survival_means <- Av_length.survival_dat %>%
dplyr::filter(Day >1) %>%
na.omit() %>%
dplyr::group_by(Day, OA, Salinity, Temp) %>%
dplyr::summarise(mean_survival = mean(Survival),
n           = n(),
sd_survival   = sd(Survival),
se_survival   = sd_survival/(sqrt(n)))
Survival_all_MeanSE_plot <- Survival_means %>%
dplyr::mutate(AllTreat = as.factor(paste(OA, Salinity, Temp, sep = '_'))) %>%
ggplot(aes(x = as.numeric(Day),
y = mean_survival,
group = AllTreat,
colour=fct_relevel(Salinity, c("Low", "High")),
linetype = Temp)) +
geom_point(aes(colour = fct_relevel(Salinity, c("Low", "High")),
shape = fct_relevel(OA, c("Low", "High"))),
width = 0.5,
position = "dodge2") +
geom_line(aes(x = as.numeric(Day),
y=mean_survival,
colour=fct_relevel(Salinity, c("Low", "High")),
linetype = Temp)) +
geom_errorbar(aes(ymin = mean_survival - se_survival,
ymax = mean_survival + se_survival),
width = 0.5, position= "dodge2") +
theme_classic() +
stat_summary(geom="ribbon", fun.data=mean_cl_normal, width=0.1, conf.int=0.95, fill="lightblue")+
facet_wrap(~(fct_relevel(OA, c("Low", "High"))))
print(Survival_all_MeanSE_plot)
print(Length_all_MeanSE_plot)
dev.off()
Length_Day1_MeanSE_plot <- Length_means %>% dplyr::filter(Age %in% 1)
Length_Day1_MeanSE_plot <- Length_means %>% dplyr::filter(Age %in% 1)
Length_Day1_MeanSE_plot <- Length_means %>%
dplyr::filter(Age %in% 1) %>%
ggplot(aes(x = Age,
y=mean_length,
colour=fct_relevel(Salinity, c("Low", "High")),
linetype = Temp)) +
geom_point(aes(fill = fct_relevel(Salinity, c("Low", "High")),
shape = fct_relevel(OA, c("Low", "High"))),
position = "dodge2") +
geom_line(aes(x = Age,
y=mean_length,
colour=fct_relevel(Salinity, c("Low", "High")),
linetype = Temp)) +
geom_errorbar(aes(ymin = mean_length - se_length,
ymax = mean_length + se_length),
width = 0.5, position= "dodge2") +
theme_classic() +
facet_wrap(~(fct_relevel(OA, c("Low", "High"))))
print(Length_Day1_MeanSE_plot)
Length_Day1_MeanSE_plot <- Length_means %>%
dplyr::filter(Age %in% c(1, 4)) %>%
ggplot(aes(x = Age,
y=mean_length,
colour=fct_relevel(Salinity, c("Low", "High")),
linetype = Temp)) +
geom_point(aes(fill = fct_relevel(Salinity, c("Low", "High")),
shape = fct_relevel(OA, c("Low", "High"))),
position = "dodge2") +
geom_line(aes(x = Age,
y=mean_length,
colour=fct_relevel(Salinity, c("Low", "High")),
linetype = Temp)) +
geom_errorbar(aes(ymin = mean_length - se_length,
ymax = mean_length + se_length),
width = 0.5, position= "dodge2") +
theme_classic() +
facet_wrap(~(fct_relevel(OA, c("Low", "High"))))
print(Length_Day1_MeanSE_plot)
Length_Day1.4_MeanSE_plot <- Length_means %>%
dplyr::filter(Age %in% c(1, 4)) %>%
ggplot(aes(x = Age,
y=mean_length,
colour=fct_relevel(Salinity, c("Low", "High")),
linetype = Temp)) +
geom_point(aes(fill = fct_relevel(Salinity, c("Low", "High")),
shape = fct_relevel(OA, c("Low", "High"))),
position = "dodge2") +
geom_line(aes(x = Age,
y=mean_length,
colour=fct_relevel(Salinity, c("Low", "High")),
linetype = Temp)) +
geom_errorbar(aes(ymin = mean_length - se_length,
ymax = mean_length + se_length),
width = 0.5, position= "dodge2") +
theme_classic() +
facet_wrap(~(fct_relevel(OA, c("Low", "High"))))
setwd("C:/Users/samjg/Documents/Github_repositories/Cvirginica_multistressor/RAnalysis")
pdf("Output/Length_Survival/Length_Day1.4_MeanSE.pdf", width=11, height=6)
print(Length_Day1.4_MeanSE_plot)
dev.off()
# length data for scallops days after day 4
Length_Days8.11.15_MeanSE_plot <- Length_means %>%
dplyr::filter(Age > 4) %>%
ggplot(aes(x = Age,
y=mean_length,
colour=fct_relevel(Salinity, c("Low", "High")),
linetype = Temp)) +
geom_point(aes(fill = fct_relevel(Salinity, c("Low", "High")),
shape = fct_relevel(OA, c("Low", "High"))),
position = "dodge2") +
geom_line(aes(x = Age,
y=mean_length,
colour=fct_relevel(Salinity, c("Low", "High")),
linetype = Temp)) +
geom_errorbar(aes(ymin = mean_length - se_length,
ymax = mean_length + se_length),
width = 0.5, position= "dodge2") +
theme_classic() +
facet_wrap(~(fct_relevel(OA, c("Low", "High"))))
print(Length_Days8.11.15_MeanSE_plot)
# length data for scallops days after day 4
Length_Days8.11.15_MeanSE_plot <- Length_means %>%
dplyr::filter(Age > 4) %>%
ggplot(aes(x = Age,
y=mean_length,
colour=fct_relevel(Salinity, c("Low", "High")),
linetype = Temp)) +
geom_point(aes(fill = fct_relevel(Salinity, c("Low", "High")),
shape = fct_relevel(OA, c("Low", "High"))),
position = "dodge2") +
geom_line(aes(x = Age,
y=mean_length,
colour=fct_relevel(Salinity, c("Low", "High")),
linetype = Temp)) +
geom_errorbar(aes(ymin = mean_length - se_length,
ymax = mean_length + se_length),
width = 0.5, position= "dodge2") +
theme_classic() +
facet_wrap(~(fct_relevel(OA, c("Low", "High"))))
print(Length_Days8.11.15_MeanSE_plot)
setwd("C:/Users/samjg/Documents/Github_repositories/Cvirginica_multistressor/RAnalysis")
pdf("Output/Length_Survival/Length_Days8.11.15_MeanSE.pdf", width=11, height=6)
print(Length_Days8.11.15_MeanSE_plot)
dev.off()
Age1Length_lme_mod <- lme(length_um~OA*Temp*Salinity,random=~1|random_fact,data=Age1_raw_length)
pander(anova(Age1Length_lme_mod), style='rmarkdown') # anova table of lmer
# |        &nbsp;        | numDF | denDF | F-value |  p-value  |
# |:--------------------:|:-----:|:-----:|:-------:|:---------:|
# |   **(Intercept)**    |   1   | 1176  | 151157  |     0     |
# |        **OA**        |   1   |  16   |  108.4  | 1.56e-08  | *
# |       **Temp**       |   1   |  16   |  18.6   | 0.0005359 | *
# |     **Salinity**     |   1   |  16   |  120.4  | 7.426e-09 | *
# |     **OA:Temp**      |   1   |  16   |  1.363  |  0.2601   |
# |   **OA:Salinity**    |   1   |  16   |  5.876  |  0.02756  | *
# |  **Temp:Salinity**   |   1   |  16   |  2.105  |  0.1661   |
# | **OA:Temp:Salinity** |   1   |  16   |  1.135  |  0.3026   |
leveneTest(residuals(Age1Length_lme_mod) ~ Age1_raw_length$Temp*Age1_raw_length$OA*Age1_raw_length$Salinity) # 0.2716 PASS
qqnorm(resid(Age1Length_lme_mod)) # check for normality of residuals
# run model (lm mod)
Age1Length_lm_mod <- lm(length_um~OA*Temp*Salinity,data=Age1_raw_length)
pander(anova(Age1Length_lm_mod), style='rmarkdown') # anova table of lmer
# |        &nbsp;        |  Df  | Sum Sq | Mean Sq | F value |  Pr(>F)   |
# |:--------------------:|:----:|:------:|:-------:|:-------:|:---------:|
# |        **OA**        |  1   |  4478  |  4478   |  419.8  | 3.562e-80 | *
# |       **Temp**       |  1   | 768.3  |  768.3  |  72.03  | 6.209e-17 | *
# |     **Salinity**     |  1   |  4974  |  4974   |  466.3  | 1.503e-87 | *
# |     **OA:Temp**      |  1   |  56.3  |  56.3   |  5.278  |  0.02177  | *
# |   **OA:Salinity**    |  1   | 242.7  |  242.7  |  22.75  | 2.069e-06 | *
# |  **Temp:Salinity**   |  1   | 86.96  |  86.96  |  8.153  | 0.004374  | *
# | **OA:Temp:Salinity** |  1   | 46.86  |  46.86  |  4.393  |  0.03629  | *
# |    **Residuals**     | 1192 | 12714  |  10.67  |   NA    |    NA     |
shapiro.test(residuals(Age1Length_lm_mod)) # 0.002907 no pass
leveneTest(residuals(Age1Length_lm_mod) ~ Age1_raw_length$Temp*Age1_raw_length$OA*Age1_raw_length$Salinity) # 0.2793 PASS
# post hoc tests --------------------------------------------------------------------------------------------------- #
posthoc<-emmeans(Age1Length_lm_mod, pairwise~OA:Salinity:Temp, adjust="tukey")
multcomp::cld(posthoc$emmeans,alpha = 0.5, Letters = letters)
# |        &nbsp;        | numDF | denDF | F-value |  p-value  |
# |:--------------------:|:-----:|:-----:|:-------:|:---------:|
# |   **(Intercept)**    |   1   | 1176  | 151157  |     0     |
# |        **OA**        |   1   |  16   |  108.4  | 1.56e-08  | *
# |       **Temp**       |   1   |  16   |  18.6   | 0.0005359 | *
# |     **Salinity**     |   1   |  16   |  120.4  | 7.426e-09 | *
# |     **OA:Temp**      |   1   |  16   |  1.363  |  0.2601   |
# |   **OA:Salinity**    |   1   |  16   |  5.876  |  0.02756  | *
# |  **Temp:Salinity**   |   1   |  16   |  2.105  |  0.1661   |
# | **OA:Temp:Salinity** |   1   |  16   |  1.135  |  0.3026   |
leveneTest(residuals(Age1Length_lme_mod) ~ Age1_raw_length$Temp*Age1_raw_length$OA*Age1_raw_length$Salinity) # 0.2716 PASS
boxplot(residuals(Age1Length_lme_mod) ~ Age1_raw_length$Temp*Age1_raw_length$OA*Age1_raw_length$Salinity) # visual of residuals grouped
pander(anova(Age1Length_lme_mod), style='rmarkdown') # anova table of lmer
# post hoc tests --------------------------------------------------------------------------------------------------- #
posthoc<-emmeans(Age1Length_lme_mod, pairwise~OA:Salinity, adjust="tukey")
multcomp::cld(posthoc$emmeans,alpha = 0.5, Letters = letters)
# run model (lm mod)
Age1Length_lm_mod <- lm(length_um~OA*Temp*Salinity,data=Age1_raw_length)
pander(anova(Age1Length_lm_mod), style='rmarkdown') # anova table of lmer
# run model (lm mod)
Age1Length_lm_mod <- lm(log(length_um)~OA*Temp*Salinity,data=Age1_raw_length)
pander(anova(Age1Length_lm_mod), style='rmarkdown') # anova table of lmer
# |        &nbsp;        |  Df  | Sum Sq | Mean Sq | F value |  Pr(>F)   |
# |:--------------------:|:----:|:------:|:-------:|:-------:|:---------:|
# |        **OA**        |  1   |  4478  |  4478   |  419.8  | 3.562e-80 | *
# |       **Temp**       |  1   | 768.3  |  768.3  |  72.03  | 6.209e-17 | *
# |     **Salinity**     |  1   |  4974  |  4974   |  466.3  | 1.503e-87 | *
# |     **OA:Temp**      |  1   |  56.3  |  56.3   |  5.278  |  0.02177  | *
# |   **OA:Salinity**    |  1   | 242.7  |  242.7  |  22.75  | 2.069e-06 | *
# |  **Temp:Salinity**   |  1   | 86.96  |  86.96  |  8.153  | 0.004374  | *
# | **OA:Temp:Salinity** |  1   | 46.86  |  46.86  |  4.393  |  0.03629  | *
# |    **Residuals**     | 1192 | 12714  |  10.67  |   NA    |    NA     |
shapiro.test(residuals(Age1Length_lm_mod)) # 0.002907 no pass
# run model (lm mod)
Age1Length_lm_mod <- lm(sqrt(length_um)~OA*Temp*Salinity,data=Age1_raw_length)
pander(anova(Age1Length_lm_mod), style='rmarkdown') # anova table of lmer
# |        &nbsp;        |  Df  | Sum Sq | Mean Sq | F value |  Pr(>F)   |
# |:--------------------:|:----:|:------:|:-------:|:-------:|:---------:|
# |        **OA**        |  1   |  4478  |  4478   |  419.8  | 3.562e-80 | *
# |       **Temp**       |  1   | 768.3  |  768.3  |  72.03  | 6.209e-17 | *
# |     **Salinity**     |  1   |  4974  |  4974   |  466.3  | 1.503e-87 | *
# |     **OA:Temp**      |  1   |  56.3  |  56.3   |  5.278  |  0.02177  | *
# |   **OA:Salinity**    |  1   | 242.7  |  242.7  |  22.75  | 2.069e-06 | *
# |  **Temp:Salinity**   |  1   | 86.96  |  86.96  |  8.153  | 0.004374  | *
# | **OA:Temp:Salinity** |  1   | 46.86  |  46.86  |  4.393  |  0.03629  | *
# |    **Residuals**     | 1192 | 12714  |  10.67  |   NA    |    NA     |
shapiro.test(residuals(Age1Length_lm_mod)) # 0.002907 no pass
pander(anova(Age1Length_lm_mod), style='rmarkdown') # anova table of lmer
Age1Length_lme_mod <- lme(length_um~OA*Temp*Salinity,random=~1|random_fact,data=Age1_raw_length)
pander(anova(Age1Length_lme_mod), style='rmarkdown') # anova table of lmer
# post hoc tests --------------------------------------------------------------------------------------------------- #
posthoc<-emmeans(Age1Length_lme_mod, pairwise~OA:Salinity, adjust="tukey")
# post hoc tests --------------------------------------------------------------------------------------------------- #
posthoc<-emmeans(Age1Length_lme_mod, pairwise~OA:Salinity, adjust="tukey")
multcomp::cld(posthoc$emmeans,alpha = 0.5, Letters = letters)
Age4Length_lme_mod <- lme(length_um~OA*Salinity*Temp,random=~1|random_fact,data=Age4_raw_length)
pander(anova(Age4Length_lme_mod), style='rmarkdown') # anova table of lmer
# |        &nbsp;        | numDF | denDF | F-value |  p-value  |
# |:--------------------:|:-----:|:-----:|:-------:|:---------:|
# |   **(Intercept)**    |   1   |  378  |  10702  |     0     |
# |        **OA**        |   1   |  16   |  30.04  | 5.033e-05 |
# |     **Salinity**     |   1   |  16   |  13.73  | 0.001921  |
# |       **Temp**       |   1   |  16   |  1.675  |   0.214   |
# |   **OA:Salinity**    |   1   |  16   | 0.6367  |  0.4366   |
# |     **OA:Temp**      |   1   |  16   |  10.42  | 0.005262  | *
# |  **Salinity:Temp**   |   1   |  16   | 0.3258  |   0.576   |
# | **OA:Salinity:Temp** |   1   |  16   |  2.811  |  0.1131   |
leveneTest(residuals(Age4Length_lme_mod) ~ Age4_raw_length$Temp*Age4_raw_length$OA*Age4_raw_length$Salinity) # 0.2059 pass
qqnorm(resid(Age4Length_lme_mod)) # check for normality of residuals - looks okay
posthoc<-emmeans(Age4Length_lme_mod, pairwise~OA:Temp, adjust="tukey")
multcomp::cld(posthoc$emmeans,alpha = 0.5, Letters = letters)
Age8Length_lme_mod <- lme(log(length_um)~OA*Salinity*Temp,random=~1|random_fact,data=Age8_raw_length)
pander(anova(Age8Length_lme_mod), style='rmarkdown') # anova table of lmer
# |        &nbsp;        | numDF | denDF | F-value |  p-value  |
# |:--------------------:|:-----:|:-----:|:-------:|:---------:|
# |   **(Intercept)**    |   1   | 1659  |  52761  |     0     |
# |        **OA**        |   1   |  16   |  17.24  | 0.0007493 |
# |     **Salinity**     |   1   |  16   |  17.66  | 0.000676  |
# |       **Temp**       |   1   |  16   |  3.026  |  0.1011   |
# |   **OA:Salinity**    |   1   |  16   | 0.08178 |  0.7786   |
# |     **OA:Temp**      |   1   |  16   |  4.522  |  0.04937  | **
# |  **Salinity:Temp**   |   1   |  16   |  3.228  |  0.09127  |
# | **OA:Salinity:Temp** |   1   |  16   |  1.939  |  0.1829   |
leveneTest(residuals(Age8Length_lme_mod) ~ Age8_raw_length$Temp*Age8_raw_length$OA*Age8_raw_length$Salinity) # < 2.2e-16 *** - did not pass
pander(anova(Age8Length_lme_mod), style='rmarkdown') # anova table of lmer
# post hoc tests --------------------------------------------------------------------------------------------------- #
posthoc<-emmeans(Age8Length_lme_mod, pairwise~OA:Temp, adjust="tukey")
multcomp::cld(posthoc$emmeans,alpha = 0.5, Letters = letters)
#data
Age8_raw_length_hightemp <- Age8_raw_length %>% dplyr::filter(!Temp %in% 'Low')
pander(anova(Age8Length_lme_mod_hightemp), style='rmarkdown') # anova table of lmer
#data
Age8_raw_length_hightemp <- Age8_raw_length %>% dplyr::filter(!Temp %in% 'Low')
# run model ( LME model)
Age8Length_lme_mod_hightemp <- lme(length_um~OA*Salinity,random=~1|random_fact,data=Age8_raw_length_hightemp) # notice temp is removed...
pander(anova(Age8Length_lme_mod_hightemp), style='rmarkdown') # anova table of lmer
Age11Length_lme_mod <- lme(length_um~OA*Salinity*Temp,random=~1|random_fact,data=Age11_raw_length)
pander(anova(Age11Length_lme_mod), style='rmarkdown') # anova table of lmer
# post hoc tests --------------------------------------------------------------------------------------------------- #
posthoc<-emmeans(Age11Length_lme_mod, pairwise~Salinity:Temp, adjust="tukey")
multcomp::cld(posthoc$emmeans,alpha = 0.5, Letters = letters)
# post hoc tests --------------------------------------------------------------------------------------------------- #
posthoc<-emmeans(Age11Length_lme_mod, pairwise~Salinity:Temp, adjust="tukey")
multcomp::cld(posthoc$emmeans,alpha = 0.5, Letters = letters)
Age15Length_lme_mod <- lmer(length_um~OA*Salinity*Temp+(1|random_fact),na.action = na.exclude,data=Age15_raw_length)
anova(Age15Length_lme_mod)
library(lme4)
library(lmerTest)
Age15Length_lme_mod <- lmer(length_um~OA*Salinity*Temp+(1|random_fact),na.action = na.exclude,data=Age15_raw_length)
anova(Age15Length_lme_mod)
# post hoc tests --------------------------------------------------------------------------------------------------- #
posthoc<-emmeans(Age15Length_lme_mod, pairwise~Salinity:Temp, adjust="tukey")
multcomp::cld(posthoc$emmeans,alpha = 0.5, Letters = letters)
# extract the experiment data with coresponding sampke Ids from the averaged data master file...
Exp_data <-  Av_length.survival_dat %>%
filter(Day %in% 1) %>%
dplyr::select(c('Temp','OA','Salinity','Replicate','Id.', 'pH', 'AR')) %>%
dplyr::rename(Sample.ID = Id., Aragonite_saturation = AR)
Exp_data
Av_length.survival_dat
# Age 1
raw_length_Age1MELT <-  reshape2::melt((as.data.frame(Masterlengthdata) %>% dplyr::filter(Age == 1))) %>%
na.omit %>%
dplyr::rename(length_um = value , Sample.ID =variable) %>%
dplyr::mutate(Sample.ID = gsub('.*Sample.','', Sample.ID))
Age1_raw_length      <- merge(raw_length_Age1MELT, Exp_data, by = 'Sample.ID')  %>%
dplyr::mutate(random_fact = paste( substr(Temp,1,1), substr(OA,1,1), substr(Salinity,1,1), '_', Replicate, sep = '')) %>%
dplyr::mutate(Age = 1)
# Age 4
raw_length_Age4MELT <-  reshape2::melt((as.data.frame(Masterlengthdata) %>% dplyr::filter(Age == 4))) %>%
na.omit %>%
dplyr::rename(length_um = value , Sample.ID =variable) %>%
dplyr::mutate(Sample.ID = gsub('.*Sample.','', Sample.ID))
Age4_raw_length      <- merge(raw_length_Age4MELT, Exp_data, by = 'Sample.ID')  %>%
dplyr::mutate(random_fact = paste( substr(Temp,1,1), substr(OA,1,1), substr(Salinity,1,1), '_', Replicate, sep = '')) %>%
dplyr::mutate(Age = 4)
# Age 8
raw_length_Age8MELT <-  reshape2::melt((as.data.frame(Masterlengthdata) %>% dplyr::filter(Age == 8))) %>%
na.omit %>%
dplyr::rename(length_um = value , Sample.ID =variable) %>%
dplyr::mutate(Sample.ID = gsub('.*Sample.','', Sample.ID))
Age8_raw_length      <- merge(raw_length_Age8MELT, Exp_data, by = 'Sample.ID')  %>%
dplyr::mutate(random_fact = paste( substr(Temp,1,1), substr(OA,1,1), substr(Salinity,1,1), '_', Replicate, sep = '')) %>%
dplyr::mutate(Age = 8)
# Age 11
raw_length_Age11MELT <-  reshape2::melt((as.data.frame(Masterlengthdata) %>% dplyr::filter(Age == 11))) %>%
na.omit %>%
dplyr::rename(length_um = value , Sample.ID =variable) %>%
dplyr::mutate(Sample.ID = gsub('.*Sample.','', Sample.ID))
Age11_raw_length      <- merge(raw_length_Age11MELT, Exp_data, by = 'Sample.ID')  %>%
dplyr::mutate(random_fact = paste( substr(Temp,1,1), substr(OA,1,1), substr(Salinity,1,1), '_', Replicate, sep = '')) %>%
dplyr::mutate(Age = 11)
# Age 15
raw_length_Age15MELT <-  reshape2::melt((as.data.frame(Masterlengthdata) %>% dplyr::filter(Age == 15))) %>%
na.omit %>%
dplyr::rename(length_um = value , Sample.ID =variable) %>%
dplyr::mutate(Sample.ID = gsub('.*Sample.','', Sample.ID))
Age15_raw_length      <- merge(raw_length_Age15MELT, Exp_data, by = 'Sample.ID')  %>%
dplyr::mutate(random_fact = paste( substr(Temp,1,1), substr(OA,1,1), substr(Salinity,1,1), '_', Replicate, sep = '')) %>%
dplyr::mutate(Age = 15)
raw_length_Age15MELT
raw_length_Age15MELT
Master_Lengths <- rbind(Age1_raw_length,
Age4_raw_length,
Age8_raw_length,
Age11_raw_length,
Age15_raw_length)
p<-ggplot(data=data, aes(x=interval, y=OR, colour=Drug)) + geom_point() + geom_line()
p<-p+geom_ribbon(aes(ymin=data$lower, ymax=data$upper), linetype=2, alpha=0.1)
Survival_means_day1         <- Av_length.survival_dat %>%
dplyr::filter(Day == 1) %>%
na.omit() %>%
dplyr::group_by(Day, OA, Salinity, Temp) %>%
dplyr::summarise(mean_survival = mean(Survival),
n           = n(),
sd_survival   = sd(Survival),
se_survival   = sd_survival/(sqrt(n)))
Survival_all_MeanSE_plot_Day1 <- Survival_means_day1 %>%
dplyr::mutate(AllTreat = as.factor(paste(OA, Salinity, Temp, sep = '_'))) %>%
ggplot(aes(x = as.numeric(Day),
y = mean_survival,
group = AllTreat,
colour=fct_relevel(Salinity, c("Low", "High")),
linetype = Temp)) +
geom_point(aes(colour = fct_relevel(Salinity, c("Low", "High")),
shape = fct_relevel(OA, c("Low", "High"))),
width = 0.5,
position = "dodge2") +
geom_line(aes(x = as.numeric(Day),
y=mean_survival,
colour=fct_relevel(Salinity, c("Low", "High")),
linetype = Temp)) +
geom_errorbar(aes(ymin = mean_survival - se_survival,
ymax = mean_survival + se_survival),
width = 0.5, position= "dodge2") +
theme_classic() +
facet_wrap(~(fct_relevel(OA, c("Low", "High"))))
Survival_means <- Av_length.survival_dat %>%
dplyr::filter(Day >1) %>%
na.omit() %>%
dplyr::group_by(Day, OA, Salinity, Temp) %>%
dplyr::summarise(mean_survival = mean(Survival),
n           = n(),
sd_survival   = sd(Survival),
se_survival   = sd_survival/(sqrt(n)))
Survival_means
Survival_all_MeanSE_plot <- Survival_means %>%
dplyr::mutate(AllTreat = as.factor(paste(OA, Salinity, Temp, sep = '_'))) %>%
ggplot(aes(x = as.numeric(Day),
y = mean_survival,
group = AllTreat,
colour=fct_relevel(Salinity, c("Low", "High")),
linetype = Temp)) +
geom_point(aes(colour = fct_relevel(Salinity, c("Low", "High")),
shape = fct_relevel(OA, c("Low", "High"))),
width = 0.5,
position = "dodge2") +
geom_line(aes(x = as.numeric(Day),
y=mean_survival,
colour=fct_relevel(Salinity, c("Low", "High")),
linetype = Temp)) +
geom_errorbar(aes(ymin = mean_survival - se_survival,
ymax = mean_survival + se_survival),
width = 0.5, position= "dodge2") +
theme_classic() +
stat_summary(geom="ribbon", fun.data=mean_cl_normal, width=0.1, conf.int=0.95, fill="lightblue")+
facet_wrap(~(fct_relevel(OA, c("Low", "High"))))
print(Survival_all_MeanSE_plot)
Survival_means
# Purpose: Bay Scallop Project - Feeding Rates
# analysis of respiration rate data
# Written by: Sam J Gurr (last edit 10/12/2021)
# Review Riisgard 2001 defining the clearance rate of bivalves
# NOTE: clearance rate is defined as the volume of water cleared of suspended particles per unit time, and only equals filtration rate when
# 100% of suspended particles are efficiently retained
# LOAD PACKAGES :::::::::::::::::::::::::::::::::::::::::::::::::::::::
library(dplyr)
library(ggplot2)
library(forcats)
library(lme4)
library(lmerTest)
library(see)
library(performance)
library(car)
library(reshape2)
library(lubridate)
library(SciViews)
library(reshape2)
library(SciViews)
library(kableExtra)
library(latex2exp)
library(pander)
library(performance)
library(ggpubr)
library(Rmisc)
# SET WORKING DIRECTORY :::::::::::::::::::::::::::::::::::::::::::::::
# setwd("C:/Users/samjg/Documents/Github_repositories/Airradians_OA-foodsupply/RAnalysis") # Work computer
setwd("C:/Users/samuel.gurr/Documents/Github_repositories/Airradians_OA-foodsupply/RAnalysis") # personal computer
# Purpose: Bay Scallop Project - Feeding Rates
# analysis of respiration rate data
# Written by: Sam J Gurr (last edit 10/12/2021)
# Review Riisgard 2001 defining the clearance rate of bivalves
# NOTE: clearance rate is defined as the volume of water cleared of suspended particles per unit time, and only equals filtration rate when
# 100% of suspended particles are efficiently retained
# LOAD PACKAGES :::::::::::::::::::::::::::::::::::::::::::::::::::::::
library(dplyr)
library(ggplot2)
library(forcats)
library(lme4)
library(lmerTest)
library(see)
library(performance)
library(car)
library(reshape2)
library(lubridate)
library(SciViews)
library(reshape2)
library(SciViews)
library(kableExtra)
library(latex2exp)
library(pander)
library(performance)
library(ggpubr)
library(Rmisc)
# SET WORKING DIRECTORY :::::::::::::::::::::::::::::::::::::::::::::::
setwd("C:/Users/samjg/Documents/Github_repositories/Airradians_OA-foodsupply/RAnalysis") # Work computer
# setwd("C:/Users/samuel.gurr/Documents/Github_repositories/Airradians_OA-foodsupply/RAnalysis") # personal computer
# LOAD DATA :::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
Master_data       <- read.csv(file="Data/Clearance_rates/ClearanceRates_MasterData.csv", header=T) # master data file
clearance.rate_914    <- Master_data  %>% dplyr::filter(Date %in% 20210914)  %>%
dplyr::mutate(Chamber_tank = paste(pH, Replicate, sep='_'))
clearance.rate_930    <- Master_data  %>% dplyr::filter(Date %in% 20210930)  %>%
dplyr::mutate(Chamber_tank = paste(pH, Replicate, sep='_'))
clearance.rate_1026    <- Master_data  %>% dplyr::filter(Date %in% 20211026)  %>%
dplyr::mutate(Chamber_tank = paste(pH, Replicate, sep='_'))
length.resp.feed <- read.csv(file="Data/Respiration/Lengths_Condition_resp_clearance.csv", header=T) %>%
dplyr::mutate(Date = paste("20",(format(as.Date(Date, "%m/%d/%Y"), "%y%m%d")), sep ='')) %>%
dplyr::rename(Fed_Unfed = Food)
length.resp.feed <- length.resp.feed[!is.na(length.resp.feed$Length_um),] %>%  dplyr::select(c('Date', 'Run', 'Plate',
'pH', 'Fed_Unfed', 'Replicate',
'Chamber_tank', 'Number', 'Length_um','whole_Dry_weight'))
length.resp.feed
