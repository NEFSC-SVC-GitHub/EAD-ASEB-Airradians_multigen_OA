sep = "")
carbchem.MASTER_wideMEANS
FINAL_TABLE$Temperature    <- paste( (paste( (signif(carbchem.MASTER_wideMEANS$Temperature_bucket_C, digits=3)),
(signif(carbchem.MASTER_wideStErr$Temperature_bucket_C, digits=3)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$Temperature_bucket_C,
")",
sep = "")
colname(carbchem.MASTER_wideMEANS)
colnames(carbchem.MASTER_wideMEANS)
FINAL_TABLE$pH             <- paste( (paste( (signif(carbchem.MASTER_wideMEANS$pH_out, digits=3)),
(signif(carbchem.MASTER_wideStErr$pH_out, digits=3)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$pH_out,
")",
sep = "")
FINAL_TABLE$pCO2           <-  paste( (paste( (signif(carbchem.MASTER_wideMEANS$xCO2_out._dry_at._1_atm_.ppm_.DIC_pH, digits=3)),
(signif(carbchem.MASTER_wideStErr$xCO2_out._dry_at._1_atm_.ppm_.DIC_pH, digits=3)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$xCO2_out._dry_at._1_atm_.ppm_.DIC_pH,
")",
sep = "")
FINAL_TABLE$HCO3           <-  paste( (paste( (signif(carbchem.MASTER_wideMEANS$HCO3_out_mmol_kgSW, digits=3)),
(signif(carbchem.MASTER_wideStErr$HCO3_out_mmol_kgSW, digits=3)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$HCO3_out_mmol_kgSW,
")",
sep = "")
FINAL_TABLE$CO3           <-  paste( (paste( (signif(carbchem.MASTER_wideMEANS$CO3_out_mmol_gSW, digits=3)),
"±",
(signif(carbchem.MASTER_wideStErr$CO3_out_mmol_gSW, digits=3)), sep="  ")),
" (",
carbchem.MASTER_wideN$CO3_out_mmol_gSW,
")",
sep = "")
FINAL_TABLE$CO3           <-  paste( (paste( (signif(carbchem.MASTER_wideMEANS$CO3_out_mmol_kgSW, digits=3)),
"±",
(signif(carbchem.MASTER_wideStErr$CO3_out_mmol_kgSW, digits=3)), sep="  ")),
" (",
carbchem.MASTER_wideN$CO3_out_mmol_kgSW,
")",
sep = "")
FINAL_TABLE$TA             <- paste( (paste( (signif(carbchem.MASTER_wideMEANS$TA_mmol_kgSW, digits=3)),
(signif(carbchem.MASTER_wideStErr$TA_mmol_kgSW, digits=3)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$TA_mmol_kgSW,
")",
sep = "")
FINAL_TABLE$Aragonite.Sat  <-  paste( (paste( (signif(carbchem.MASTER_wideMEANS$War_out_DIC_pH, digits=3)),
(signif(carbchem.MASTER_wideStErr$War_out_DIC_pH, digits=3)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$War_out_DIC_pH,
")",
sep = "")
FINAL_TABLE                <- FINAL_TABLE[,-1] # view table
FINAL_TABLE %>%
kbl(caption = "Table 1. Seawater chemistry") %>%
kable_classic(full_width = T, html_font = "Cambria")
FINAL_TABLE$pCO2
FINAL_TABLE$pCO2           <-  paste( (paste( (signif(carbchem.MASTER_wideMEANS$xCO2_out._dry_at._1_atm_.ppm_.DIC_pH, digits=3)),
(signif(carbchem.MASTER_wideStErr$xCO2_out._dry_at._1_atm_.ppm_.DIC_pH, digits=3)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$xCO2_out._dry_at._1_atm_.ppm_.DIC_pH,
")",
sep = "")
carbchem.MASTER_MEANS <- carbchem.MASTER_long %>% # calc means and standard error
na.omit() %>%
dplyr::group_by(pCO2_treatment, variable) %>%
dplyr::summarise(mean = mean(value),
sd   = sd(value),
se   = sd/(sqrt(n())) ,
n = n())
chem_meanDate <- carbchem.MASTER_MEANS %>%
na.omit() %>%
dplyr::group_by(pCO2_treatment, variable) %>%
dplyr::summarise(mean2 = mean(mean),
sd   = sd(mean),
se   = sd/(sqrt(n())) ,
n = n())
carbchem.MASTER_wideMEANS <- dcast(chem_meanDate, pCO2_treatment ~ variable, value.var="mean2")
carbchem.MASTER_wideStErr <- dcast(chem_meanDate, pCO2_treatment ~ variable, value.var="se")
carbchem.MASTER_wideN     <- dcast(chem_meanDate, pCO2_treatment ~ variable, value.var="n")
# final table
colnames(carbchem.MASTER_wideMEANS)
FINAL_TABLE                <- data.frame(matrix(nrow = nrow(carbchem.MASTER_wideMEANS), ncol = 1))
FINAL_TABLE$pCO2_Treatment <- carbchem.MASTER_wideMEANS$pCO2_treatment
FINAL_TABLE$Salinity       <-  paste( (paste( (signif(carbchem.MASTER_wideMEANS$Salinity, digits=3)),
(signif(carbchem.MASTER_wideStErr$Salinity, digits=3)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$Salinity,
")",
sep = "")
FINAL_TABLE$pCO2           <-  paste( (paste( (signif(carbchem.MASTER_wideMEANS$pCO2_out_matm, digits=3)),
(signif(carbchem.MASTER_wideStErr$pCO2_out_matm, digits=3)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$pCO2_out_matm,
")",
sep = "")
FINAL_TABLE$Temperature    <- paste( (paste( (signif(carbchem.MASTER_wideMEANS$Temperature_bucket_C, digits=3)),
(signif(carbchem.MASTER_wideStErr$Temperature_bucket_C, digits=3)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$Temperature_bucket_C,
")",
sep = "")
FINAL_TABLE$pH             <- paste( (paste( (signif(carbchem.MASTER_wideMEANS$pH_out, digits=3)),
(signif(carbchem.MASTER_wideStErr$pH_out, digits=3)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$pH_out,
")",
sep = "")
FINAL_TABLE$pCO2           <-  paste( (paste( (signif(carbchem.MASTER_wideMEANS$xCO2_out._dry_at._1_atm_.ppm_.DIC_pH, digits=3)),
(signif(carbchem.MASTER_wideStErr$xCO2_out._dry_at._1_atm_.ppm_.DIC_pH, digits=3)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$xCO2_out._dry_at._1_atm_.ppm_.DIC_pH,
")",
sep = "")
FINAL_TABLE$HCO3           <-  paste( (paste( (signif(carbchem.MASTER_wideMEANS$HCO3_out_mmol_kgSW, digits=3)),
(signif(carbchem.MASTER_wideStErr$HCO3_out_mmol_kgSW, digits=3)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$HCO3_out_mmol_kgSW,
")",
sep = "")
FINAL_TABLE$CO3           <-  paste( (paste( (signif(carbchem.MASTER_wideMEANS$CO3_out_mmol_kgSW, digits=3)),
"±",
(signif(carbchem.MASTER_wideStErr$CO3_out_mmol_kgSW, digits=3)), sep="  ")),
" (",
carbchem.MASTER_wideN$CO3_out_mmol_kgSW,
")",
sep = "")
FINAL_TABLE$TA             <- paste( (paste( (signif(carbchem.MASTER_wideMEANS$TA_mmol_kgSW, digits=3)),
(signif(carbchem.MASTER_wideStErr$TA_mmol_kgSW, digits=3)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$TA_mmol_kgSW,
")",
sep = "")
FINAL_TABLE$Aragonite.Sat  <-  paste( (paste( (signif(carbchem.MASTER_wideMEANS$War_out_DIC_pH, digits=3)),
(signif(carbchem.MASTER_wideStErr$War_out_DIC_pH, digits=3)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$War_out_DIC_pH,
")",
sep = "")
FINAL_TABLE                <- FINAL_TABLE[,-1] # view table
FINAL_TABLE %>%
kbl(caption = "Table 1. Seawater chemistry") %>%
kable_classic(full_width = T, html_font = "Cambria")
carbchem.MASTER_MEANS <- carbchem.MASTER_long %>% # calc means and standard error
na.omit() %>%
dplyr::group_by(pCO2_treatment, variable) %>%
dplyr::summarise(mean = mean(value),
sd   = sd(value),
se   = sd/(sqrt(n())) ,
n = n())
chem_meanDate <- carbchem.MASTER_MEANS %>%
na.omit() %>%
dplyr::group_by(pCO2_treatment, variable) %>%
dplyr::summarise(mean2 = mean(mean),
sd   = sd(mean2),
se   = sd/(sqrt(n())) ,
n = n())
carbchem.MASTER_wideMEANS <- dcast(chem_meanDate, pCO2_treatment ~ variable, value.var="mean2")
carbchem.MASTER_wideStErr <- dcast(chem_meanDate, pCO2_treatment ~ variable, value.var="se")
carbchem.MASTER_wideN     <- dcast(chem_meanDate, pCO2_treatment ~ variable, value.var="n")
# final table
colnames(carbchem.MASTER_wideMEANS)
FINAL_TABLE                <- data.frame(matrix(nrow = nrow(carbchem.MASTER_wideMEANS), ncol = 1))
FINAL_TABLE$pCO2_Treatment <- carbchem.MASTER_wideMEANS$pCO2_treatment
FINAL_TABLE$Salinity       <-  paste( (paste( (signif(carbchem.MASTER_wideMEANS$Salinity, digits=3)),
(signif(carbchem.MASTER_wideStErr$Salinity, digits=3)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$Salinity,
")",
sep = "")
FINAL_TABLE$pCO2           <-  paste( (paste( (signif(carbchem.MASTER_wideMEANS$pCO2_out_matm, digits=3)),
(signif(carbchem.MASTER_wideStErr$pCO2_out_matm, digits=3)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$pCO2_out_matm,
")",
sep = "")
FINAL_TABLE$Temperature    <- paste( (paste( (signif(carbchem.MASTER_wideMEANS$Temperature_bucket_C, digits=3)),
(signif(carbchem.MASTER_wideStErr$Temperature_bucket_C, digits=3)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$Temperature_bucket_C,
")",
sep = "")
FINAL_TABLE$pH             <- paste( (paste( (signif(carbchem.MASTER_wideMEANS$pH_out, digits=3)),
(signif(carbchem.MASTER_wideStErr$pH_out, digits=3)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$pH_out,
")",
sep = "")
FINAL_TABLE$pCO2           <-  paste( (paste( (signif(carbchem.MASTER_wideMEANS$xCO2_out._dry_at._1_atm_.ppm_.DIC_pH, digits=3)),
(signif(carbchem.MASTER_wideStErr$xCO2_out._dry_at._1_atm_.ppm_.DIC_pH, digits=3)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$xCO2_out._dry_at._1_atm_.ppm_.DIC_pH,
")",
sep = "")
FINAL_TABLE$HCO3           <-  paste( (paste( (signif(carbchem.MASTER_wideMEANS$HCO3_out_mmol_kgSW, digits=3)),
(signif(carbchem.MASTER_wideStErr$HCO3_out_mmol_kgSW, digits=3)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$HCO3_out_mmol_kgSW,
")",
sep = "")
FINAL_TABLE$CO3           <-  paste( (paste( (signif(carbchem.MASTER_wideMEANS$CO3_out_mmol_kgSW, digits=3)),
"±",
(signif(carbchem.MASTER_wideStErr$CO3_out_mmol_kgSW, digits=3)), sep="  ")),
" (",
carbchem.MASTER_wideN$CO3_out_mmol_kgSW,
")",
sep = "")
FINAL_TABLE$TA             <- paste( (paste( (signif(carbchem.MASTER_wideMEANS$TA_mmol_kgSW, digits=3)),
(signif(carbchem.MASTER_wideStErr$TA_mmol_kgSW, digits=3)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$TA_mmol_kgSW,
")",
sep = "")
FINAL_TABLE$Aragonite.Sat  <-  paste( (paste( (signif(carbchem.MASTER_wideMEANS$War_out_DIC_pH, digits=3)),
(signif(carbchem.MASTER_wideStErr$War_out_DIC_pH, digits=3)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$War_out_DIC_pH,
")",
sep = "")
FINAL_TABLE                <- FINAL_TABLE[,-1] # view table
FINAL_TABLE %>%
kbl(caption = "Table 1. Seawater chemistry") %>%
kable_classic(full_width = T, html_font = "Cambria")
chem_meanDate <- carbchem.MASTER_MEANS %>%
na.omit() %>%
dplyr::group_by(pCO2_treatment, variable) %>%
dplyr::summarise(mean2 = mean(mean),
sd   = sd(mean2),
se   = sd/(sqrt(n())) ,
n = n())
chem_meanDate
chem_meanDate <- carbchem.MASTER_MEANS %>%
carbchem.MASTER_MEANS
carbchem.MASTER_MEANS <- carbchem.MASTER_long %>% # calc means and standard error
na.omit() %>%
dplyr::group_by(pCO2_treatment, variable) %>%
dplyr::summarise(mean = mean(value),
sd   = sd(value),
se   = sd/(sqrt(n())) ,
n = n())
carbchem.MASTER_MEANS
# aquire means by group for mean SE plotting by Date and treamtent
carbchem.MASTER_MEANS <- carbchem.MASTER_long %>% # calc means and standard error
na.omit() %>%
dplyr::group_by(Date, Type, pCO2_treatment, variable) %>%
dplyr::summarise(mean = mean(value),
sd   = sd(value),
se   = sd/(sqrt(n())) )
carbchem.MASTER_MEANS <- carbchem.MASTER_long %>% # calc means and standard error
na.omit() %>%
dplyr::group_by(Date, Type, pCO2_treatment, variable) %>%
dplyr::summarise(mean = mean(value),
sd   = sd(value),
se   = sd/(sqrt(n())) )
chem_meanDate <- carbchem.MASTER_MEANS %>%
na.omit() %>%
dplyr::group_by(pCO2_treatment, variable) %>%
dplyr::summarise(mean2 = mean(mean),
sd   = sd(mean2),
se   = sd/(sqrt(n())) ,
n = n())
carbchem.MASTER_wideMEANS <- dcast(chem_meanDate, pCO2_treatment ~ variable, value.var="mean2")
carbchem.MASTER_wideStErr <- dcast(chem_meanDate, pCO2_treatment ~ variable, value.var="se")
carbchem.MASTER_wideN     <- dcast(chem_meanDate, pCO2_treatment ~ variable, value.var="n")
# final table
colnames(carbchem.MASTER_wideMEANS)
FINAL_TABLE                <- data.frame(matrix(nrow = nrow(carbchem.MASTER_wideMEANS), ncol = 1))
FINAL_TABLE$pCO2_Treatment <- carbchem.MASTER_wideMEANS$pCO2_treatment
FINAL_TABLE$Salinity       <-  paste( (paste( (signif(carbchem.MASTER_wideMEANS$Salinity, digits=3)),
(signif(carbchem.MASTER_wideStErr$Salinity, digits=3)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$Salinity,
")",
sep = "")
FINAL_TABLE$pCO2           <-  paste( (paste( (signif(carbchem.MASTER_wideMEANS$xCO2_out._dry_at._1_atm_.ppm_.DIC_pH, digits=3)),
(signif(carbchem.MASTER_wideStErr$xCO2_out._dry_at._1_atm_.ppm_.DIC_pH, digits=3)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$xCO2_out._dry_at._1_atm_.ppm_.DIC_pH,
")",
sep = "")
FINAL_TABLE$Temperature    <- paste( (paste( (signif(carbchem.MASTER_wideMEANS$Temperature_bucket_C, digits=3)),
(signif(carbchem.MASTER_wideStErr$Temperature_bucket_C, digits=3)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$Temperature_bucket_C,
")",
sep = "")
FINAL_TABLE$pH             <- paste( (paste( (signif(carbchem.MASTER_wideMEANS$pH_out, digits=3)),
(signif(carbchem.MASTER_wideStErr$pH_out, digits=3)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$pH_out,
")",
sep = "")
FINAL_TABLE$HCO3           <-  paste( (paste( (signif(carbchem.MASTER_wideMEANS$HCO3_out_mmol_kgSW, digits=3)),
(signif(carbchem.MASTER_wideStErr$HCO3_out_mmol_kgSW, digits=3)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$HCO3_out_mmol_kgSW,
")",
sep = "")
FINAL_TABLE$CO3           <-  paste( (paste( (signif(carbchem.MASTER_wideMEANS$CO3_out_mmol_kgSW, digits=3)),
"±",
(signif(carbchem.MASTER_wideStErr$CO3_out_mmol_kgSW, digits=3)), sep="  ")),
" (",
carbchem.MASTER_wideN$CO3_out_mmol_kgSW,
")",
sep = "")
FINAL_TABLE$TA             <- paste( (paste( (signif(carbchem.MASTER_wideMEANS$TA_mmol_kgSW, digits=3)),
(signif(carbchem.MASTER_wideStErr$TA_mmol_kgSW, digits=3)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$TA_mmol_kgSW,
")",
sep = "")
FINAL_TABLE$Aragonite.Sat  <-  paste( (paste( (signif(carbchem.MASTER_wideMEANS$War_out_DIC_pH, digits=3)),
(signif(carbchem.MASTER_wideStErr$War_out_DIC_pH, digits=3)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$War_out_DIC_pH,
")",
sep = "")
FINAL_TABLE                <- FINAL_TABLE[,-1] # view table
FINAL_TABLE %>%
kbl(caption = "Table 1. Seawater chemistry") %>%
kable_classic(full_width = T, html_font = "Cambria")
carbchem.MASTER_MEANS <- carbchem.MASTER_long %>% # calc means and standard error
na.omit() %>%
dplyr::group_by(Date, Type, pCO2_treatment, variable) %>%
dplyr::summarise(mean = mean(value),
sd   = sd(value),
se   = sd/(sqrt(n())) )
carbchem.MASTER_MEANS
chem_meanDate <- carbchem.MASTER_MEANS %>%
na.omit() %>%
dplyr::group_by(pCO2_treatment, variable) %>%
dplyr::summarise(mean2 = mean(mean),
sd   = sd(mean),
se   = sd/(sqrt(n())) ,
n = n())
carbchem.MASTER_wideMEANS <- dcast(chem_meanDate, pCO2_treatment ~ variable, value.var="mean2")
carbchem.MASTER_wideStErr <- dcast(chem_meanDate, pCO2_treatment ~ variable, value.var="se")
carbchem.MASTER_wideN     <- dcast(chem_meanDate, pCO2_treatment ~ variable, value.var="n")
# final table
colnames(carbchem.MASTER_wideMEANS)
FINAL_TABLE                <- data.frame(matrix(nrow = nrow(carbchem.MASTER_wideMEANS), ncol = 1))
FINAL_TABLE$pCO2_Treatment <- carbchem.MASTER_wideMEANS$pCO2_treatment
FINAL_TABLE$Salinity       <-  paste( (paste( (signif(carbchem.MASTER_wideMEANS$Salinity, digits=3)),
(signif(carbchem.MASTER_wideStErr$Salinity, digits=3)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$Salinity,
")",
sep = "")
FINAL_TABLE$pCO2           <-  paste( (paste( (signif(carbchem.MASTER_wideMEANS$xCO2_out._dry_at._1_atm_.ppm_.DIC_pH, digits=3)),
(signif(carbchem.MASTER_wideStErr$xCO2_out._dry_at._1_atm_.ppm_.DIC_pH, digits=3)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$xCO2_out._dry_at._1_atm_.ppm_.DIC_pH,
")",
sep = "")
FINAL_TABLE$Temperature    <- paste( (paste( (signif(carbchem.MASTER_wideMEANS$Temperature_bucket_C, digits=3)),
(signif(carbchem.MASTER_wideStErr$Temperature_bucket_C, digits=3)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$Temperature_bucket_C,
")",
sep = "")
FINAL_TABLE$pH             <- paste( (paste( (signif(carbchem.MASTER_wideMEANS$pH_out, digits=3)),
(signif(carbchem.MASTER_wideStErr$pH_out, digits=3)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$pH_out,
")",
sep = "")
FINAL_TABLE$HCO3           <-  paste( (paste( (signif(carbchem.MASTER_wideMEANS$HCO3_out_mmol_kgSW, digits=3)),
(signif(carbchem.MASTER_wideStErr$HCO3_out_mmol_kgSW, digits=3)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$HCO3_out_mmol_kgSW,
")",
sep = "")
FINAL_TABLE$CO3           <-  paste( (paste( (signif(carbchem.MASTER_wideMEANS$CO3_out_mmol_kgSW, digits=3)),
"±",
(signif(carbchem.MASTER_wideStErr$CO3_out_mmol_kgSW, digits=3)), sep="  ")),
" (",
carbchem.MASTER_wideN$CO3_out_mmol_kgSW,
")",
sep = "")
FINAL_TABLE$TA             <- paste( (paste( (signif(carbchem.MASTER_wideMEANS$TA_mmol_kgSW, digits=3)),
(signif(carbchem.MASTER_wideStErr$TA_mmol_kgSW, digits=3)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$TA_mmol_kgSW,
")",
sep = "")
FINAL_TABLE$Aragonite.Sat  <-  paste( (paste( (signif(carbchem.MASTER_wideMEANS$War_out_DIC_pH, digits=3)),
(signif(carbchem.MASTER_wideStErr$War_out_DIC_pH, digits=3)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$War_out_DIC_pH,
")",
sep = "")
FINAL_TABLE                <- FINAL_TABLE[,-1] # view table
FINAL_TABLE %>%
kbl(caption = "Table 1. Seawater chemistry") %>%
kable_classic(full_width = T, html_font = "Cambria")
carbchem.MASTER_long
unique(carbchem.MASTER_long$Date)
unique(carbchem.MASTER_long$Date)
# LOAD PACKAGES :::::::::::::::::::::::::::::::::::::::::::::::::::::::
library(dplyr)
library(ggplot2)
library(reshape2)
library(knitr)
library(kableExtra)
library(car)
# SET WORKING DIRECTORY :::::::::::::::::::::::::::::::::::::::::::::::
setwd("C:/Users/samjg/Documents/Github_repositories/Airradians_multigen_OA/RAnalysis/") # personal computer
# LOAD DATA :::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
chem_larvae <- read.csv(file="Data/Chemistry/F1/cumulative_raw/F1_water_chemistry_raw_larvae.csv", header=TRUE) # load the chem data
chem_spat.adult <- read.csv(file="Data/Chemistry/F1/cumulative_raw/F1_water_chemistry_raw.csv", header=TRUE) # load the chem data
ncol(chem_larvae) == ncol(chem_spat.adult) # TRUE - same spreadsheet
colnames(chem_larvae) == colnames(chem_spat.adult) # TRUE - also the same
chem.MASTER <- rbind(chem_larvae, chem_spat.adult)
carbchem                <- chem.MASTER[!(is.na(chem.MASTER$War_out_DIC_pH)),]
carbchem.flagged.DIC.TA <- subset(carbchem, (TCO2_mmol_kgSW > TA_mmol_kgSW)) # 13 rows flagged for DIC<TA
carbchem.flagged.odd    <- subset(carbchem, War_out_DIC_pH > 400) # 8 w/ high aragonite, next highest is 2.05
write.csv((rbind(carbchem.flagged.DIC.TA, carbchem.flagged.odd)), "C:/Users/samjg/Documents/Github_repositories/Airradians_multigen_OA/RAnalysis/Output/SeawaterChemistry/F1s/flagged_data.csv")
carbchem.MASTER         <- subset(carbchem, !(TCO2_mmol_kgSW > TA_mmol_kgSW)) %>% # DIC>TA omit
dplyr::filter(War_out_DIC_pH < 3) %>% # omit these odd aragonite points
dplyr::mutate(pCO2_treatment =
case_when(Treatment == 8 ~ 'Low',
Treatment == 7.5 ~ 'Moderate',
Treatment == 7 ~ 'Severe'))
write.csv(carbchem.MASTER, "C:/Users/samjg/Documents/Github_repositories/Airradians_multigen_OA/RAnalysis/Output/SeawaterChemistry/F1s/master/CarbChem_master.csv")
```{r plotting}
# change to long format to properly facet
carbchem.MASTER_long <- carbchem.MASTER %>%
dplyr::select(!c(Treatment,Replicate)) %>%
melt(id.vars=c('Date', 'Type', 'pCO2_treatment'))
carbchem.MASTER_long$value <- as.numeric(carbchem.MASTER_long$value) # make numeric
# aquire means by group for mean SE plotting by Date and treamtent
carbchem.MASTER_MEANS <- carbchem.MASTER_long %>% # calc means and standard error
na.omit() %>%
dplyr::group_by(Date, Type, pCO2_treatment, variable) %>%
dplyr::summarise(mean = mean(value),
sd   = sd(value),
se   = sd/(sqrt(n())) )
# plot em!
colnames(carbchem.MASTER) # target select
pd <- position_dodge(0.1) # adjust the jitter for the different treatments
Larvae <- carbchem.MASTER_MEANS %>%
dplyr::filter(Type %in% 'Larvae') %>%
dplyr::filter(variable %in% (c('Temperature_bucket_C',
'Salinity',
'DO_mg_l',
'pH',
'pH_out',
'TCO2_mmol_kgSW',
'TA_mmol_kgSW',
'War_out_DIC_pH',
'Wca_out'))) %>%
ggplot(aes(x=Date, y=mean, shape=Type, colour=factor(pCO2_treatment))) +
geom_errorbar(aes(ymin=mean-se, ymax=mean+se), colour="black", width=.1, position=pd) +
geom_line(position=pd) +
scale_colour_manual(values = c("Low" = "green",
"Moderate"="orange",
"Severe" = "purple")) +
theme_classic() +
geom_point(position=pd, size=2) +
theme(axis.text.x = element_text(angle = 45, hjust=1, size = 5)) +
#scale_y_continuous(expand = c(0, 0), limits = c(0, 300000)) +
facet_wrap(~variable, scales = "free")
print(Larvae)
carbchem.MASTER_MEANS <- carbchem.MASTER_long %>% # calc means and standard error
na.omit() %>%
dplyr::group_by(Date, Type, pCO2_treatment, variable) %>%
dplyr::summarise(mean = mean(value),
sd   = sd(value),
se   = sd/(sqrt(n())) )
chem_meanDate <- carbchem.MASTER_MEANS %>%
na.omit() %>%
dplyr::group_by(pCO2_treatment, variable) %>%
dplyr::summarise(mean2 = mean(mean),
sd   = sd(mean),
se   = sd/(sqrt(n())) ,
n = n())
carbchem.MASTER_wideMEANS <- dcast(chem_meanDate, pCO2_treatment ~ variable, value.var="mean2")
carbchem.MASTER_wideStErr <- dcast(chem_meanDate, pCO2_treatment ~ variable, value.var="se")
carbchem.MASTER_wideN     <- dcast(chem_meanDate, pCO2_treatment ~ variable, value.var="n")
carbchem.MASTER_MEANS
carbchem.MASTER_long
carbchem.MASTER
# NOTE (as of 1/28/2022): 9/28/2021 DIC data is reversed between 7.5 and 8 buckets - need to ping the team to fix
# LOAD PACKAGES
library(dplyr)
library(ggplot2)
library(kableExtra)
library(data.table)
library(stringr)
library(latex2exp)
library(Rmisc)
library(kableExtra)
library(ggpubr)
# SET WORKING DIRECTORY :::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
setwd("C:/Users/samjg/Documents/Github_repositories/Airradians_OA-foodsupply/RAnalysis") # personal computer
#  setwd("C:/Users/samuel.gurr/Documents/Github_repositories/Airradians_OA-foodsupply/RAnalysis") # Work computer
# LOAD & FORMAT THE DATA
# All data  ::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
chem    <- data.frame(read.csv(file="Data/Seawater_chemistry/Water_Chemistry_Scallops_2021.csv", header=T, sep = '\t')) %>%
dplyr::filter(!X  %in% c('Checking the system', 'RESPO', 'Tank Farm', 'Blue bucket check')) # %>%  # ommit all occurances of 'checks' of the system
# dplyr::rename(Date = ï..Date)
chem$Date <- as.factor(gsub("/2021.*","", chem$Date))
# FOOD  OA CHALLENGE ONLY  ::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
# foodxOAchem    <- data.frame(read.csv(file="Data/Seawater_chemistry/Water_Chemistry_FoodxOA_Challenge.csv", header=T))[,c(1:20)] %>%
#   dplyr::filter(!(Date %in% "10/12/2021" & Food.Treatment %in% 'Low')) %>% # omit 10/12/2021 measurements for the 'Low' Food treatment (check notebook, I think CO2 turned off overnight?)
#   dplyr::filter(!X %in% 'checking the system') %>%  # ommit all occurances of 'checks' of the system
#   na.omit()
CarbChemfoodxOAchem    <- data.frame(read.csv(file="Data/Seawater_chemistry/MasterTable_FoodxOA.csv", header=T)) %>%
dplyr::filter(!Date %in% '9/24/2021') # two measurements on 9/24 for static depuration buckets - omit for our analysis
CarbChemfoodxOAchem
